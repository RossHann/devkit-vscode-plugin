<app-banner></app-banner>
<div class="analysis-container">
    <div class="analysis-content">
        <div class="main">
            <div class="cntent-title">
                <span>{{i18n.plugins_porting_analysis_center_title}}
                </span>
                <a *ngIf="currLang === 'zh-cn'" class="normal-btn" (click)="downloadSoFile(pluginUrlCfg.faqThirteenZn)">
                    <img *ngIf="currTheme === 1" src="./assets/img/icon-help-dark.svg">
                    <img *ngIf="currTheme === 2" src="./assets/img/icon-help-light.svg">
                </a>
                <a *ngIf="currLang === 'en' || currLang === 'en-us'" class="normal-btn" (click)="downloadSoFile(pluginUrlCfg.faqThirteenEn)">
                    <img *ngIf="currTheme === 1" src="./assets/img/icon-help-dark.svg">
                    <img *ngIf="currTheme === 2" src="./assets/img/icon-help-light.svg">
                </a>
            </div>
            <div class="cntent-title-desc">{{i18n.plugins_porting_analysis_center_tip}}</div>

            <!--选择待重构软件包-->
            <div class="analysis-step"
                [ngClass]="{'select-step': curPackStep === 1,'executed-step': curPackStep > 1 ,'analysis-step-color': intelliJFlagDef}">
                <span class="step-num"
                    [ngClass]="{'select-num': curPackStep === 1, 'executed-num': curPackStep > 1}">1</span>
                <span class="step-lable-color"
                    [ngClass]="{'select-lable-color': curPackStep === 1, 'executed-lable-color': curPackStep > 1}">{{i18n.plugins_porting_analysis_package_select}}</span>
            </div>
            <div class="cntent-step-desc">
                <div class="cntent-desc-area" *ngIf="curPackStep === 1">
                    <span [ngClass]="{ 'newBack': isX86Evn, 'label-radio-local': !isX86Evn}">
                        <label class="ra-label" for="local">
                            <i class="ra-common ra-check" *ngIf="packageLocation === 'local' && !isX86Evn"></i>
                            <i class="ra-common ra-uncheck" *ngIf="packageLocation !== 'local'"></i>
                            <i class="ra-common ra-uncheck-x86" *ngIf="packageLocation === 'local' && isX86Evn"></i>
                            <input class="radio-size" name="upload-type" type="radio" value='local' id='local'
                                [(ngModel)]='packageLocation' style="height: 20px; display: none"
                                (ngModelChange)="onLocationChange($event)" (change)="packageLocation === 'local'"
                                [disabled]="isX86Evn" />
                            <span style="margin-left: 26px;">{{i18n.plugins_porting_uploaded_package}}</span>
                        </label>
                    </span>
                    <span [ngClass]="{ 'newBack': isX86Evn, 'label-radio-upload': !isX86Evn}" style="padding-left: 50px;">
                        <label class="ra-label" for="upload">
                            <i class="ra-common ra-check" *ngIf="packageLocation === 'upload'"></i>
                            <i class="ra-common ra-uncheck" *ngIf="packageLocation !== 'upload' && !isX86Evn"></i>
                            <i class="ra-common ra-uncheck-x86" *ngIf="packageLocation !== 'upload' && isX86Evn"></i>
                            <input class="radio-size" name="upload-type" type="radio" value='upload' id='upload'
                                [(ngModel)]='packageLocation' style="height: 20px; display: none"
                                (ngModelChange)="onLocationChange($event)" (change)="packageLocation === 'upload'"
                                [disabled]="isX86Evn" />
                            <span style="margin-left: 26px;">{{i18n.plugins_porting_local_upload}}</span>
                        </label>
                    </span>
                </div>

                <div class="cntent-desc-area">
                    <div class="cntent-desc-area-color" style="display: flex;">
                        <span class="label " style="margin-bottom: 3px;" [ngClass]="{ 'newBack': isX86Evn}">
                            <span
                                class="ti3-icon"
                                [ngClass]="{ 'ti3-icon-staricon': curPackStep === 1}">
                            </span>{{i18n.plugins_porting_analysis_center_save_path}}</span>
                        <span class="label" style="margin-bottom: 3px; flex: 1; padding-left: 4px;" tiOverflow
                            [ngClass]="{ 'newBack': isX86Evn}">{{fileFullPath}}</span>
                    </div>
                    <div *ngIf="curPackStep === 1">
                        <span class="value">
                            <span class="value-row" *ngIf="!isX86Evn">
                                <textarea class="isX86Evn ? dis-style : edit-style" type="text"
                                    [ngStyle]="{'height': isDisplay === 'none' ? '98px': '28px', 'resize': 'vertical'}"
                                    [(ngModel)]="filename" [ngClass]="{'err-border': isBlank, 'dis-border': isX86Evn}"
                                    (focus)="getCheck()" (blur)="isRight()" [placeholder]="inputPrompt"
                                    (input)="inputAreaMatch()" (keyup)="keyupAreaMatch()"
                                    [disabled]="isX86Evn" [formControl]="filenameLength" [tiValidation]="validationChange"></textarea>
                                <button (click)="zipUpload()" type="button" [ngStyle]="{'display': isDisplay}"
                                    [disabled]="isX86Evn"
                                    class="little-minor-btn">{{i18n.plugins_porting_analysis_upload}}</button>
                                <input type="file" id="zipload" style="display: none;"
                                    (change)="uploadFilePack('normal')" accept=".rpm,.deb" />
                            </span>
                            <span class="dis-value-row" *ngIf="isX86Evn">
                                <textarea class="edit-style" type="text"
                                    [ngStyle]="{'height': isDisplay === 'none' ? '70px': '28px', 'resize': 'vertical'}"
                                    [(ngModel)]="filename" [ngClass]="{'err-border': isBlank, 'dis-border': isX86Evn}"
                                    (focus)="getCheck()" (blur)="isRight()" [placeholder]="inputPrompt"
                                    (input)="inputAreaMatch()" (keyup)="keyupAreaMatch()"
                                    [disabled]="isX86Evn"></textarea>
                                <button (click)="zipUpload()" type="button" [ngStyle]="{'display': isDisplay}"
                                    [disabled]="isX86Evn"
                                    class="little-minor-btn">{{i18n.plugins_porting_analysis_upload}}</button>
                                <input type="file" id="zipload" style="display: none;"
                                    (change)="uploadFilePack('normal')" accept=".rpm,.deb" />
                            </span>
                            <span>
                                <p *ngIf="isBlank" class="ti3-unifyvalid-error-container">
                                    <span class="ti3-validate-icon ti3-icon ti3-icon-exclamation-circle"></span>
                                    <span class="ti3-validate-text">{{ filenameTip }}</span>
                                </p>
                            </span>
                        </span>
                    </div>
                    <div class="areaMatchDiv" [ngStyle]="{top: areaMatchHeight + 'px'}"
                        *ngIf="displayAreaMatch && (pathlist.length !== 0) && packageLocation === 'local'">
                        <ul>
                            <li style="margin: 0;cursor: pointer;" *ngFor="let path of pathlist" (mousedown)="clickAreaMatch(path)">
                                <p (mousedown)="clickAreaMatch(path)">{{path}}</p>
                                <div (mousedown)="isDeleteAreaMatch(path)">
                                    <img src="./assets/img/analysis/icon_delete_normal.svg"
                                        onmouseover="this.src='./assets/img/analysis/icon_delete_hover.svg'"
                                        onmouseout="this.src='./assets/img/analysis/icon_delete_normal.svg'" alt="" />
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <!--配置依赖文件-->
            <div class="analysis-step"
                [ngClass]="{'select-step': curPackStep === 2,'executed-step': curPackStep > 2 ,'analysis-step-color': intelliJFlagDef}">
                <span class="step-num"
                    [ngClass]="{'select-num': curPackStep === 2,'executed-num': curPackStep > 2}">2</span>
                <span class="step-lable-color"
                    [ngClass]="{'select-lable-color': curPackStep === 2, 'executed-lable-color': curPackStep > 2}">{{i18n.plugins_porting_analysis_resource_select}}</span>
            </div>
            <div class="cntent-step-desc" *ngIf="curPackStep >= 2">
                <div class="cntent-desc-area">
                    <div class="cntent-desc-area-color">
                        <span class="label" style="margin-bottom: 3px;"
                            [ngClass]="{ 'newBack': isX86Evn}">{{i18n.plugins_porting_analysis_resource_save_path}}</span>
                        <span class="label" style="margin-bottom: 3px;">{{userPathData}}</span>
                    </div>
                    <div *ngIf="curPackStep === 2">
                        <span class="value">
                            <span class="value-row" style="float: left;" *ngIf="!isX86Evn">
                                <textarea class="resource-edit-style" type="text" [(ngModel)]="filenameData"
                                    [ngClass]="{'err-border': isBlankData, 'dis-border': isX86Evn}"
                                    (focus)="getCheckData()" (blur)="isRightData()" [placeholder]="inputPromptData"
                                    (input)="inputAreaMatchData()" (keyup)="keyupAreaMatchData()" [disabled]="isX86Evn"
                                    [formControl]="filenameLengthForData" [tiValidation]="validationChange">
                                </textarea>
                            </span>
                            <span class="dis-value-row" style="float: left;" *ngIf="isX86Evn">
                                <textarea class="resource-edit-style" type="text" [(ngModel)]="filenameData"
                                    [ngClass]="{'err-border': isBlankData, 'dis-border': isX86Evn}"
                                    (focus)="getCheckData()" (blur)="isRightData()" [placeholder]="inputPromptData"
                                    (input)="inputAreaMatchData()" (keyup)="keyupAreaMatchData()" [disabled]="isX86Evn">
                                </textarea>
                            </span>
                            <span class="value-row">
                                <button (click)="filesUpload()" type="button" class="little-minor-btn"
                                    [disabled]="isX86Evn" [ngClass]="{ 'disable-btn': isX86Evn}">
                                    {{i18n.plugins_porting_analysis_upload}}
                                    <input type="file" id="files" style="display: none;"
                                        (change)="uploadFileData('normal')" />
                                </button>
                            </span>
                            <span *ngIf="isDangerous" class="error-message">
                                <span class="ti3-validate-icon ti3-icon ti3-icon-exclamation-circle"></span>
                                <span class="ti3-validate-text">{{dangerousMessage}}</span>
                            </span>
                        </span>
                    </div>
                    <div class="areaMatchDiv" [ngStyle]="{top: areaMatchHeight + 'px'}"
                        *ngIf="displayAreaMatchData && (pathlistData.length !== 0)">
                        <ul>
                            <li style="margin: 0;cursor: pointer;" *ngFor="let path of pathlistData"
                                (mousedown)="clickAreaMatchData(path)">
                                <p (mousedown)="clickAreaMatchData(path)">{{path}}</p>
                                <div (mousedown)="isDeleteAreaMatchData(path)">
                                    <img src="./assets/img/analysis/icon_delete_normal.svg"
                                        onmouseover="this.src='./assets/img/analysis/icon_delete_hover.svg'"
                                        onmouseout="this.src='./assets/img/analysis/icon_delete_normal.svg'" alt="" />
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>

                <div class="cntent-desc-area" *ngIf="(curPackStep === 2) || (curPackStep > 2 && isCheck)">
                    <span class="value-authorizate" [ngClass]="{ 'disable-color': isX86Evn}">
                        <input type="checkbox" tiCheckbox [(ngModel)]="isCheck"
                            [disabled]="isX86Evn || (curPackStep > 2 && isCheck)" *ngIf="!isX86Evn">
                        <div class="newBox" *ngIf="isX86Evn"></div>
                        <span class="common_term_author">{{i18n.common_term_author}}</span>
                    </span>
                </div>
            </div>

            <div style="margin-top: 20px; height: 8px;" class="cntent-step-desc cntent-desc-area"
                *ngIf="curPackStep === 1"></div>

            <!--执行重构-->
            <div class="analysis-step"
                [ngClass]="{'select-step': curPackStep === 3,'executed-step': curPackStep > 3 ,'analysis-step-color': intelliJFlagDef}">
                <span class="step-num" [ngClass]="{'select-num': curPackStep >= 3}">3</span>
                <span class="step-lable-color"
                    [ngClass]="{'select-lable-color': curPackStep >= 3}">{{i18n.plugins_porting_analysis_package_repack}}</span>
            </div>
            <div class="cntent-desc-area pack-btn" *ngIf="curPackStep > 1">
                <button type="button" class="btn-pre" [disabled]="isX86Evn || curPackStep > 3"
                    (click)="previous()">{{i18n.plugins_porting_analysis_previous}}</button>
            </div>
            <div class="cntent-desc-area pack-btn" [tiTip]="packageBtnDisabledTipX86" tiTipPosition='right' *ngIf="curPackStep < 3">
                <button type="button" *ngIf="curPackStep < 3"
                    [ngClass]="{'intellij-primary-btn btn-move': intelliJFlagDef, 'btn-next': !intelliJFlagDef}"
                    [disabled]="isX86Evn || filename === '' || curPackStep > 3 || isWebpacking || dangerFlag" (click)="next()">
                    {{i18n.plugins_porting_analysis_next}}
                </button>
            </div>
            <div class="cntent-desc-area pack-btn" [tiTip]="packageBtnDisabledTip" tiTipPosition='right' *ngIf="curPackStep > 2">
                <button type="button" *ngIf="curPackStep > 2"
                    [ngClass]="{'intellij-primary-btn btn-move': intelliJFlagDef, 'btn-next': !intelliJFlagDef}"
                    [disabled]="isX86Evn || filename === '' || curPackStep > 3 || isWebpacking || dangerFlag" (click)="next()">
                    {{i18n.plugins_porting_analysis_confirm_repack}}
                </button>
            </div>
        </div>

        <div class="package-tip">
            <div class="tip-title">
                <p>{{i18n.plugins_porting_analysis_build_Tip}}</p>
            </div>
            <div class=tip_item>
                <p class="tip_item_space">{{i18n.plugins_porting_analysis_os_Tip}}</p>
                <p class="tip_item_space">{{i18n.plugins_porting_analysis_rpm_Tip}}</p>
                <p class="tip_item_space">{{i18n.plugins_porting_analysis_dep_Tip}}</p>
                <p class="tip_item_space">{{i18n.plugins_porting_analysis_jre_Tip}}</p>
                <p class="tip_item_space">{{userchange}}</p>
                <p class="tip_item_space">{{i18n.plugins_porting_analysis_http_Tip}}</p>
            </div>
        </div>
    </div>
</div>

<!-- 上传的RPM包在鲲鹏镜像站已存在(centos7.6)，可通过配置鲲鹏镜像源进行重构。 -->
<app-messagebox #maskConfig>
    <div class="content config-modal">
        <p class="mask-title">
            <span>{{i18n.plugins_porting_message_analysis_center.title}}</span>
            <span class="close-btn" (click)="closeMaskConfig()"><img class="tip-title-close" alt=""
                    src="./assets/img/install/icon-close.svg" /></span>
        </p>
        <div class="mask-container">
            <div class="des config-missor">
                <p>{{i18n.plugins_porting_message_analysis_center.rpmUnexit}}</p>
            </div>
            <div class="des-source">
                <div
                    [ngClass]="{'des-source-item-intellij': intelliJFlagDef, 'des-source-item': !intelliJFlagDef}"
                    *ngFor="let item of stepsMirrorSource">
                    <p><span>{{item.name}}</span><a (click)="downloadItemFile(item.url)">{{item.url}}</a></p>
                </div>
            </div>
            <div class="steps">
                <div class="step-item" *ngFor="let item of stepsMirror; let i = index; let last = last">
                    <div class="step">
                        <p>{{item.step}}</p>
                    </div>
                    <div class="desMore" [ngClass]="{'desMoreLast': last}">
                        <div *ngIf="item.desMore" class="desMoreContent">
                            <p>
                                <img src="./assets/img/analysis/copy.svg"
                                (click)="copyInpValue(item, 1, copy1)"
                                [tiTip]='copySuccess'
                                tiTipTrigger='manual'
                                #copy1='tiTip' />
                                {{item.desMore}}
                                <input class='input' />
                            </p>
                            <p *ngIf="item.desMoreExtra" style="margin-top: 4px">
                                <img src="./assets/img/analysis/copy.svg"
                                (click)="copyInpValue(item, 2, copy2)"
                                [tiTip]='copySuccess'
                                tiTipTrigger='manual'
                                #copy2='tiTip' />
                                {{item.desMoreExtra}}
                                <input class='input' />
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="btn-box" style="margin-top: 24px;">
            <button *ngIf="!intelliJFlagDef" type="button" tiButton class="user-sure-btn primary-btn"
                (click)="pack(1)">{{i18n.plugins_porting_message_analysis_center.rebuild}}</button>
            <button *ngIf="!intelliJFlagDef" type="button" tiButton class="user-close-btn little-minor-btn"
                (click)="closeMaskConfig()">{{i18n.common_term_operate_cancel}}</button>
            <button *ngIf="intelliJFlagDef" type="button" tiButton class="user-sure-btn-intellij  primary-btn"
                (click)="pack(1)">{{i18n.plugins_porting_message_analysis_center.rebuild}}</button>
            <button *ngIf="intelliJFlagDef" type="button" tiButton class="user-close-btn-intellij little-minor-btn"
                (click)="closeMaskConfig()">{{i18n.common_term_operate_cancel}}</button>
        </div>
    </div>
</app-messagebox>

<!-- 上传的RPM包在鲲鹏镜像站已存在(非centos7.6)，请按对应的版本下载RPM包使用或查看移植指导 -->
<app-messagebox #maskDownload>
    <div class="content config-modal">
        <p class="mask-title">
            <span>{{i18n.plugins_porting_message_analysis_center.title}}</span>
            <span class="close-btn" (click)="closeMaskDownload()"><img class="tip-title-close" alt=""
                    src="./assets/img/install/icon-close.svg" /></span>
        </p>
        <div class="mask-container">
            <div class="des">
                <img class="des-warn-icon" alt="" src="./assets/img/home/warn.png" />
                <p>{{i18n.plugins_porting_message_analysis_center.rpmExit}}</p>
            </div>
            <ti-table style="margin-bottom: 32px;" [(displayedData)]="displayed" [srcData]="srcData"
                [columns]="columns">
                <div class="ti3-table-fixed-head">
                    <table>
                        <thead>
                            <tr>
                                <th tiOverflow *ngFor="let column of columns" width="{{column.width}}">
                                    {{column.title}}
                                </th>
                            </tr>
                        </thead>
                    </table>
                </div>
                <div class="ti3-table-container">
                    <table>
                        <thead>
                            <tr>
                                <th tiOverflow *ngFor="let column of columns" width="{{column.width}}"></th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let row of displayed;">
                                <td tiOverflow>{{row.resourcename}}</td>
                                <td tiOverflow>{{row.rpm_version}}</td>
                                <td tiOverflow>{{row.os_name}}</td>
                                <td tiOverflow><a class="targetUrl"
                                        (click)="downMirror(row.rpm_url)">{{i18n.common_term_operate_download}}</a>
                                </td>
                                <td tiOverflow><a *ngIf="row.doc_url !== ''" [href]="row.doc_url"
                                        class="targetUrl">{{i18n.plugins_porting_message_analysis_center.view}}</a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </ti-table>
        </div>
        <div class="btn-box">
            <button type="button" tiButton class="user-sure-btn primary-btn"
                (click)="pack(1)">{{i18n.plugins_porting_message_analysis_center.rebuild}}</button>
            <button type="button" tiButton class="user-close-btn little-minor-btn"
                (click)="closeMaskDownload()">{{i18n.common_term_operate_cancel}}</button>
        </div>
    </div>
</app-messagebox>

<!-- 上传重复文件 modal start -->
<app-messagebox #exitmask>
    <div class="content config-modal">
        <p class="mask-title">
            <span>{{i18n.plugins_porting_message_analysis_center.exit.title}}</span>
            <span class="close-btn" (click)="closeMaskExit()">
                <img class="tip-title-close" alt="" src="./assets/img/install/icon-close.svg" /></span>
        </p>
        <div class="mask-container">
            <div class="des">
                <img class="des-warn-icon noSpace" alt="" src="./assets/img/home/warn.png" />
                <p *ngIf="isUploadPack">{{exitFileNameReplace}}</p>
                <p *ngIf="!isUploadPack">{{exitFileNameReplaceData}}</p>
            </div>
        </div>
        <div class="btn-box">
            <button type="button" tiButton color="primary"
            [ngClass]="{'primary-btn user-sure-btn user-intellij-primary-btn': intelliJFlagDef, 'user-little-btn small-primary-btn': !intelliJFlagDef}"
                (click)="uploadAgain('override')">{{i18n.plugins_porting_message_analysis_center.exit.replace}}</button>
            <button type="button" tiButton
            [ngClass]="{'little-minor-btn user-intellij-little-btn': intelliJFlagDef, 'user-little-btn little-minor-btn': !intelliJFlagDef}"
                (click)="uploadAgain('save_as')" style="display: none;">{{i18n.plugins_porting_message_analysis_center.exit.save_as}}</button>
            <button type="button" tiButton
            [ngClass]="{'little-minor-btn user-intellij-little-btn': intelliJFlagDef, 'user-little-btn little-minor-bt': !intelliJFlagDef}"
                (click)="closeMaskExit()">{{i18n.plugins_common_button_term_operate_cancel}}</button>
        </div>
    </div>
</app-messagebox>
<!-- 上传重复文件 modal end -->

<!-- 另存为 modal start -->
<app-messagebox #saveasmask>
    <div class="content config-modal">
        <p class="mask-title">
            <span>{{i18n.plugins_porting_message_analysis_center.exit.save_as}}</span>
            <span class="close-btn" (click)="closeMaskSaveAs()">
                <img class="tip-title-close" alt="" src="./assets/img/install/icon-close.svg" /></span>
        </p>
        <div class="mask-container">
            <div class="saveAs">
                <span><span
                        class="ti3-icon ti3-icon-staricon"></span>{{i18n.plugins_porting_message_analysis_center.exit.file_name}}</span>
                <div class="formArea">
                    <ti-formfield>
                        <ti-item [label]="confirmName.pack.label">
                            <input *ngIf="isUploadPack" class="command-input" type="text" tiText
                                [(ngModel)]="exitFileName" [tiValidation]="validation"
                                [formControl]="confirmUploadZip" />
                            <input *ngIf="!isUploadPack" class="command-input" type="text" tiText
                                [(ngModel)]="exitFileNameData" [tiValidation]="validation"
                                [formControl]="confirmUploadZip" />
                        </ti-item>
                    </ti-formfield>
                </div>
            </div>
        </div>
        <div class="btn-box">
            <button type="button" tiButton class="user-sure-btn primary-btn"
                (click)="saveAs('save_as')">{{i18n.plugins_common_button_term_operate_ok}}</button>
            <button type="button" tiButton class="user-close-btn little-minor-btn"
                (click)="closeMaskSaveAs()">{{i18n.plugins_common_button_term_operate_cancel}}</button>
        </div>
    </div>
</app-messagebox>
<!-- 另存为 modal end -->

<app-messagebox #uploadConfirmTip>
    <div class="content config-modal modal-box">
        <p class="mask-title">
            <span>{{i18n.plugins_porting_migration_compatible_tip_title}}</span>
            <span class="close-btn" (click)="cancelUploadMsgTip()">
                <img class="tip-title-close" alt="" src="./assets/img/install/icon-close.svg" /></span>
        </p>
        <div class="mask-container">
            <div class="des">
                <img class="des-warn-icon" alt="" src="./assets/img/home/intellij_icon_tip.svg" />
                <p *ngIf="isUploadPack">{{i18n.plugins_porting_migration_compatible_tip}}</p>
            </div>
        </div>
        <div class="btn-box">
            <button type="button" tiButton class="user-sure-btn user-intellij-primary-btn primary-btn"
                (click)="confirmUploadMsgTip()">{{i18n.plugins_porting_migration_tip_confirm}}</button>
            <button type="button" tiButton class="user-intellij-little-btn little-minor-btn"
                (click)="cancelUploadMsgTip()">{{i18n.plugins_common_button_term_operate_cancel}}</button>
        </div>
    </div>
</app-messagebox>
<app-messagebox #uploadDepPackageModal>
    <div class="content config-modal upload-dep-package-modal">
        <p class="mask-title">
            <span>{{i18n.plugins_porting_software_relay_file.title}}</span>
            <span class="close-btn" (click)="cancelUploadDepPackageHandler()">
                <img class="tip-title-close" alt="" src="./assets/img/install/icon-close.svg" /></span>
        </p>
        <div class="modal-body">
            <div class="drop-area" [ngStyle]="{'font-size': intelliJFlagDef ? '14px' : '16px'}"
                (drop)="dropHandler($event)" (dragover)="dragOverHandler($event)">
                <ti-table *ngIf="srcDepPackageData.data.length > 0" class="ucd-tiny3-table-style"
                    [srcData]="srcDepPackageData" [(displayedData)]="displayedDepPackage">
                    <!-- 实际表头 -->
                    <div class="ti3-table-fixed-head">
                        <table>
                            <thead>
                                <tr>
                                    <ng-container *ngFor="let column of columnsDepPackage">
                                        <th tiOverflow *ngIf="column.show || column.show === undefined"
                                            [width]="column.width">
                                            <ti-cell-text>{{ column.title }}</ti-cell-text>
                                            <ti-head-sort *ngIf="column.canSort" [sortKey]="column.prop"
                                                (click)="clearSort()">
                                            </ti-head-sort>
                                        </th>
                                    </ng-container>
                                </tr>
                            </thead>
                        </table>
                    </div>
                    <div class="ti3-table-container">
                        <table>
                            <thead>
                                <tr>
                                    <ng-container *ngFor="let column of columnsDepPackage">
                                        <th tiOverflow *ngIf="column.show || column.show === undefined"
                                            [width]="column.width"></th>
                                    </ng-container>
                                </tr>
                            </thead>
                            <tbody>
                                <tr
                                    *ngFor="let row of displayedDepPackage; let index = index; trackBy: uploadDepPackageTrackFn">

                                    <td tiOverflow [ngClass]="{'error': !row.canUpload && !row.canReplace}">
                                        {{ row.fileName }}</td>
                                    <td tiOverflow [ngClass]="{'error': !row.canUpload && !row.canReplace}">
                                        {{ row.fileSizeFormatted }}
                                    </td>
                                    <td tiOverflow *ngIf="depPackageUploadStatus !== 'preUpload'">
                                        <div *ngIf="row.uploadStatus" class="upload-status">
                                            <span class="status-icon"
                                                [ngStyle]="{'background-color': row.uploadStatus === i18n.common_term_upload_success ? '#61D274' : '#ED4B4B'}"></span>
                                            <span>{{ row.uploadStatus }}</span>
                                        </div>
                                    </td>
                                    <td tiOverflow *ngIf="depPackageUploadStatus !== 'preUpload'">
                                        {{ row.detail }}</td>
                                    <td tiOverflow class="operation">
                                        <div *ngIf="depPackageUploadStatus === 'preUpload'">
                                            <button class="text-btn" (click)="deleteSrcDepPackageDataRow(row.fileName)" style="text-align: left;">
                                                {{ i18n.common_term_operate_del }}
                                            </button>
                                        </div>
                                        <div
                                            *ngIf="depPackageUploadStatus !== 'preUpload' && row.uploadStatus === i18n.common_term_upload_fail">
                                            <button class="text-btn" *ngIf="row.canReplace"
                                                (click)="showReplaceDepPackageModal(row)"
                                                [disabled]="depPackageUploadStatus !== 'postUpload'" style="text-align: left;">
                                                {{ i18n.plugins_porting_message_analysis_center.exit.replace }}
                                            </button>
                                            <button class="text-btn" *ngIf="!row.canReplace && row.canUpload"
                                                (click)="retryUploadDepPackage(row)"
                                                [disabled]="depPackageUploadStatus !== 'postUpload'" style="text-align: left;">
                                                {{ i18n.plugins_porting_button_retry }}
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </ti-table>
                <div *ngIf="srcDepPackageData.data.length === 0" class="drop-area-text">
                    <img *ngIf="currTheme === 1" src="./assets/img/drop-upload-dark.svg">
                    <img *ngIf="currTheme === 2" src="./assets/img/drop-upload-light.svg">
                    <p *ngIf="!intelliJFlagDef">
                        <span>{{ i18n.plugins_porting_software_relay_file.des1 }}</span>
                        <label for="drop-area-btn" class="normal-btn">{{ i18n.plugins_porting_software_relay_file.des2
                            }}</label>
                        <input id="drop-area-btn" type="file" multiple (input)="dropAreaBtnHandler($event)"
                            (click)="dropAreaBtnHandler($event)">
                    </p>
                    <p *ngIf="intelliJFlagDef">
                        <label for="drop-area-btn" class="normal-btn">{{ i18n.plugins_porting_software_relay_file.des2
                           }}</label>
                        <input id="drop-area-btn" type="file" multiple (input)="dropAreaBtnHandler($event)"
                             (click)="dropAreaBtnHandler($event)">
                    </p>
                    <p>({{ i18n.plugins_porting_software_relay_file.tip }})</p>
                </div>
            </div>
            <div class="under-text">
                <div class="under-text-left" *ngIf="showUploadDepPackageProgress">
                    <span tiOverflow>
                        {{ uploadingDepPackageName + i18n.plugins_porting_software_relay_file.progressSuffix }}
                    </span>
                    <app-progress></app-progress>
                </div>
                <div class="under-text-right">
                    <p *ngIf="depPackageUploadStatus === 'preUpload' && srcDepPackageData.data.length === 0">
                        {{ srcDepPackageData.data.length }}{{ i18n.plugins_porting_software_relay_file.fileNum }}
                    </p>
                    <p *ngIf="depPackageUploadStatus !== 'postUpload' && srcDepPackageData.data.length > 0">
                        <span>{{ sucessUploadDepPackageNum() }}{{ i18n.plugins_porting_software_relay_file.fileTitle
                            }}</span>
                        &nbsp;
                        <span>{{ i18n.plugins_porting_software_relay_file.successSize }}{{
                            getCanUploadDepPackageTotalSize() }}</span>
                    </p>
                    <p *ngIf="depPackageUploadStatus === 'postUpload'">
                        <span>{{ getUploadedDepPackageNum() }}{{ i18n.plugins_porting_software_relay_file.successFile
                            }}</span>
                        &nbsp;
                        <span>{{ i18n.plugins_porting_software_relay_file.successSize }}{{
                            getUploadedDepPackageTotalSize() }}</span>
                    </p>
                </div>
            </div>
        </div>
        <div class="btn-box" *ngIf="depPackageUploadStatus !== 'postUpload'">
            <button *ngIf="!intelliJFlagDef" type="button" tiButton class="user-sure-btn primary-btn"
                [disabled]="depPackageUploadStatus === 'uploading' || getCanUploadDepPackageNum() === 0"
                (click)="startUploadDepPackage()">{{ i18n.common_term_upload_code }}</button>
            <button *ngIf="intelliJFlagDef" type="button" tiButton class="user-sure-btn-intellij intellij-primary-btn"
                [ngClass]="{'uploacBack':getCanUploadDepPackageNum() === 0 }"
                [disabled]="depPackageUploadStatus === 'uploading' || getCanUploadDepPackageNum() === 0"
                (click)="startUploadDepPackage()">{{ i18n.common_term_upload_code }}</button>
            <button *ngIf="intelliJFlagDef" type="button" tiButton class="user-close-btn-intellij  little-minor-btn"
                [disabled]="depPackageUploadStatus === 'uploading'"
                (click)="intellijfilesUpload('nomal')">{{ i18n.plugins_common_button_addcode }}</button>
            <label *ngIf="!intelliJFlagDef" for="add-file-btn" class="add-file-btn secondary-btn" [tiDisabled]="depPackageUploadStatus === 'uploading'">
                {{ i18n.plugins_common_button_addcode }}
            </label>
            <input
                id="add-file-btn"
                type="file" class="dis-none"
                multiple (input)="dropAreaBtnHandler($event)" (click)="dropAreaBtnHandler($event)" [disabled]="depPackageUploadStatus === 'uploading'">
            <button *ngIf="!intelliJFlagDef" type="button" tiButton class="user-close-btn little-minor-btn"
                (click)="cancelUploadDepPackageHandler()">{{ i18n.plugins_common_button_term_operate_cancel }}</button>
            <button *ngIf="intelliJFlagDef" type="button" tiButton class="user-close-btn-intellij little-minor-btn"
                (click)="cancelUploadDepPackageHandler()">{{ i18n.plugins_common_button_term_operate_cancel }}</button>
        </div>
        <div class="btn-box" *ngIf="depPackageUploadStatus === 'postUpload'">
            <button type="button" tiButton class="user-close-btn little-minor-btn" (click)="closeUploadDepPackage()">{{
                i18n.common_term_operate_close }}</button>
        </div>
        <div *ngIf="showDepPackageModalLoading" class="loading">
            <app-loading bgColor="transparent" height="100%"></app-loading>
        </div>
    </div>
</app-messagebox>

<app-messagebox #cancelDepPackageModal>
    <div class="content config-modal replace-dep-package-modal">
        <p class="mask-title">
            <span>{{ i18n.plugins_porting_software_relay_file.cancelTipTitle }}</span>
            <span class="close-btn" (click)="cancelDepPackageModal.Close()">
                <img class="tip-title-close" alt="" src="./assets/img/install/icon-close.svg" /></span>
        </p>
        <div class="mask-container">
            <div class="des del">
                <img class="des-warn-icon" alt="" src="./assets/img/home/warn.png" />
                <p>{{ i18n.plugins_porting_software_relay_file.cancelTip }}</p>
            </div>
        </div>
        <div class="btn-box">
            <button type="button" tiButton class="user-sure-btn primary-btn"
                (click)="cancelUploadDepPackage()">{{i18n.plugins_common_button_term_operate_ok}}</button>
            <button type="button" tiButton class="user-close-btn little-minor-btn"
                (click)="cancelDepPackageModal.Close()">{{i18n.plugins_common_button_term_operate_cancel}}</button>
        </div>
    </div>
</app-messagebox>

<app-messagebox #replaceDepPackageModal>
    <div class="content config-modal replace-dep-package-modal">
        <p class="mask-title">
            <span>{{i18n.plugins_porting_software_relay_file.replaceTitle}}</span>
            <span class="close-btn" (click)="replaceDepPackageModal.Close()">
                <img class="tip-title-close" alt="" src="./assets/img/install/icon-close.svg" /></span>
        </p>
        <div class="mask-container">
            <div class="des del">
                <img class="des-warn-icon" alt="" src="./assets/img/home/warn.png" />
                <p>{{ replaceDepPackageTip }}</p>
            </div>
        </div>
        <div class="btn-box">
            <button type="button" tiButton class="user-sure-btn primary-btn"
                (click)="replaceDepPackage()">{{i18n.plugins_common_button_term_operate_ok}}</button>
            <button type="button" tiButton class="user-close-btn little-minor-btn"
                (click)="replaceDepPackageModal.Close()">{{i18n.plugins_common_button_term_operate_cancel}}</button>
        </div>
    </div>
</app-messagebox>

<!-- 文件名是否含有 aarch64 | arm64  modal-->
<app-messagebox #aarch64Modal>
    <div class="content modal-box">
        <div class="modal-title">
            <span class="title-content">{{i18n.common_term_modal.relayArm.title}}</span>
            <span (click)="fileModalCancel()" class="modal-close-icon">
                <img src="./assets/img/install/icon-close.svg">
                <img src="./assets/img/install/icon-close-hover.svg">
            </span>
        </div>
        <div class="modal-tip-dsc">
            <img src="./assets/img/home/icon_tip.svg" />
            <p>{{i18n.common_term_modal.relayArm.content}}</p>
        </div>
        <div class="modal-group-btn">
            <button type="button" class="btn-confirm"
                (click)="fileModalConfirm('normal')">{{i18n.common_term_operate_ok}}</button>
            <button type="button" class="btn-cancel"
                (click)="fileModalCancel()">{{i18n.common_term_operate_cancel}}</button>
        </div>
    </div>
</app-messagebox>
