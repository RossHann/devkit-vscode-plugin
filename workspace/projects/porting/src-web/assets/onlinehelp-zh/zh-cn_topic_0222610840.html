
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="zh-cn" xml:lang="zh-cn">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="topic">
<meta name="DC.Title" content="重构软件包常见失败场景">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="zh-cn_topic_0000001191872229.html">
<meta name="prodname" content="">
<meta name="version" content="2.3.0">
<meta name="brand" content="鲲鹏代码迁移工具">
<meta name="DC.Publisher" content="20211230">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="ZH-CN_TOPIC_0222610840">
<meta name="DC.Language" content="zh-cn">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="public_sys-resources/pygments.css">
<title>重构软件包常见失败场景</title>
</head>
<body style="clear:both; padding-left:10px; padding-top:5px; padding-right:5px; padding-bottom:5px"><a name="ZH-CN_TOPIC_0222610840"></a><a name="ZH-CN_TOPIC_0222610840"></a>


  
  
<h1 class="topictitle1">重构软件包常见失败场景</h1>
<div id="body1581076744749"><p id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_p8060118">重构软件包常见失败场景请参见<a href="#ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_table2012413504013">表1</a>中的处理建议解决。</p>
<div class="note" id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_note108951558183714"><img src="public_sys-resources/note_3.0-zh-cn.png"><span class="notetitle"> </span><div class="notebody"><p id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_p389555823719"><span class="filepath" id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_filepath176251195617">“/opt/portadv”</span>为工具安装目录，请根据实际情况替换。</p>
</div></div>

<div class="tablenoborder"><a name="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_table2012413504013"></a><a name="zh-cn_topic_0228242418_zh-cn_topic_0219642917_table2012413504013"></a><table cellpadding="4" cellspacing="0" summary="" id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_table2012413504013" frame="border" border="1" rules="all"><caption><b>表1 </b>重构软件包常见失败场景</caption><colgroup><col style="width:24%"><col style="width:23%"><col style="width:53%"></colgroup><thead align="left"><tr id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_row212513519408"><th align="left" class="cellrowborder" valign="top" width="24%" id="mcps1.3.3.2.4.1.1"><p id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_p9125535154012">失败场景</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="23%" id="mcps1.3.3.2.4.1.2"><p id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_p141251235194019">可能原因</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="53%" id="mcps1.3.3.2.4.1.3"><p id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_p51251235104015">处理建议</p>
</th>
</tr>
</thead>
<tbody><tr id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_row94941462516"><td class="cellrowborder" valign="top" width="24%" headers="mcps1.3.3.2.4.1.1 "><p id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_p3274132354315">缺少对应SO/静态库/JAR/二进制文件</p>
</td>
<td class="cellrowborder" valign="top" width="23%" headers="mcps1.3.3.2.4.1.2 "><p id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_p527422312435">SO/静态库/JAR/二进制文件无法自动下载。</p>
</td>
<td class="cellrowborder" valign="top" width="53%" headers="mcps1.3.3.2.4.1.3 "><p id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_p12414195255811">手动下载SO/静态库/JAR/二进制文件并放入“/opt/portadv/xx/data”目录（xx代表用户名），重新执行“重构软件包”。</p>
<div class="note" id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_note25711831145913"><span class="notetitle"> 说明： </span><div class="notebody"><ul id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_ul12302151614917"><li id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_li1630313161892">可在重构报告中查看详细信息并按照提示操作。</li><li id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_li1052371715915">缺少SO/静态库/二进制文件时，请自行获取对应名称的SO/静态库/二进制文件（如通过下载方式获取SO/静态库/二进制文件，请解压RPM或DEB包取出对应名称的SO/静态库/二进制文件）放入“/opt/portadv/xx/data”目录（xx代表用户名）后重新执行“重构软件包”。</li></ul>
</div></div>
</td>
</tr>
<tr id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_row18273152394320"><td class="cellrowborder" valign="top" width="24%" headers="mcps1.3.3.2.4.1.1 "><p id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_p9273172344315">JAR文件下载失败</p>
</td>
<td class="cellrowborder" valign="top" width="23%" headers="mcps1.3.3.2.4.1.2 "><p id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_p16274202312438">网络连接超时或磁盘空间不足。</p>
</td>
<td class="cellrowborder" valign="top" width="53%" headers="mcps1.3.3.2.4.1.3 "><ul id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_ul178141032122216"><li id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_li11814532142213">检查网络配置、参考<a href="zh-cn_topic_0290794907.html">配置代理</a>检查代理配置或检查“/opt”目录空间大小。</li><li id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_li5815173216226">手动下载JAR文件并放入“/opt/portadv/xx/data”目录（xx代表用户名），重新执行“重构软件包”。<div class="note" id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_note1938102545718"><span class="notetitle"> 说明： </span><div class="notebody"><p id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_p13821225135710">需要手动下载的JAR文件名称及下载路径可以在重构报告中查看。</p>
</div></div>
</li></ul>
</td>
</tr>
<tr id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_row4395935184116"><td class="cellrowborder" valign="top" width="24%" headers="mcps1.3.3.2.4.1.1 "><p id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_p1139743518417">分析RPM/DEB包内部SO/JAR/静态库/二进制文件失败</p>
</td>
<td class="cellrowborder" valign="top" width="23%" headers="mcps1.3.3.2.4.1.2 "><p id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_p17397235194119">磁盘空间不足、RPM/DEB包格式错误或软件包不需要迁移。</p>
</td>
<td class="cellrowborder" valign="top" width="53%" headers="mcps1.3.3.2.4.1.3 "><p id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_p123975351412">检查“/opt”目录空间大小、检查RPM/DEB包内容完整、格式正确或使用鲲鹏代码迁移工具确认软件包是否需要迁移。</p>
</td>
</tr>
<tr id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_row1420114211412"><td class="cellrowborder" valign="top" width="24%" headers="mcps1.3.3.2.4.1.1 "><p id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_p9201342174111">提取与分析control文件失败、提取与分析spec文件失败</p>
</td>
<td class="cellrowborder" valign="top" width="23%" headers="mcps1.3.3.2.4.1.2 "><p id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_p142011420419">磁盘空间不足或RPM/DEB包格式错误。</p>
</td>
<td class="cellrowborder" valign="top" width="53%" headers="mcps1.3.3.2.4.1.3 "><p id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_p178511618475">检查“/opt”目录空间大小或检查RPM/DEB包内容完整、格式正确。</p>
</td>
</tr>
<tr id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_row142661556164219"><td class="cellrowborder" valign="top" width="24%" headers="mcps1.3.3.2.4.1.1 "><p id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_p1026615684219">重新重构失败</p>
</td>
<td class="cellrowborder" valign="top" width="23%" headers="mcps1.3.3.2.4.1.2 "><p id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_p9266175617422">可能是由于文件替换失败（系统缺少JAR命令或者JAR包内嵌JAR包）、工作空间rpmbuilder未清理或者分析RPM/DEB包出错。</p>
</td>
<td class="cellrowborder" valign="top" width="53%" headers="mcps1.3.3.2.4.1.3 "><ul id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_ul97817579286"><li id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_li7816141921216">如果系统缺少JAR命令，请安装JDK工具。<div class="note" id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_note1023371945813"><span class="notetitle"> 说明： </span><div class="notebody"><p id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_p725761911583">不支持JAR包内嵌JAR包的软件包重构。</p>
</div></div>
</li><li id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_li778195762816">（针对RPM包）执行如下命令清理工作空间后重新执行“重构软件包”。<div class="codecoloring" codetype="Bash" id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_screen8842025123411"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nb">cd</span>  /opt/portadv/
rm -rf rpmbuilder
mkdir -pv ./rpmbuilder/<span class="o">{</span>BUILD,BUILDROOT,RPMS,SOURCES,SPECS,SRPMS<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</li><li id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0219642917_li1791861418292">（针对DEB包）执行如下命令清理工作空间后重新执行“重构软件包”。<div class="codecoloring" codetype="Bash" id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_screen832313561372"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>rm -rf /opt/portadv/tmp_path
</pre></div>
</td></tr></table></div>
</li></ul>
</td>
</tr>
<tr id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_row5736128141520"><td class="cellrowborder" valign="top" width="24%" headers="mcps1.3.3.2.4.1.1 "><p id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_p1515431111205">因缺少rpmrebuild导致的软件包重构失败</p>
</td>
<td class="cellrowborder" valign="top" width="23%" headers="mcps1.3.3.2.4.1.2 "><p id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_p87371228151512">服务器上未安装rpmrebuild包</p>
</td>
<td class="cellrowborder" valign="top" width="53%" headers="mcps1.3.3.2.4.1.3 "><ul id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_ul189753120282"><li id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_li998431122816">安装rpmrebuild：自行下载rpmrebuild组件，并上传至服务器执行以下命令安装。<div class="codecoloring" codetype="Bash" id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0229764399_zh-cn_topic_0212788399_screen55122221412"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>rpm -ivh xxx.rpm
</pre></div>
</td></tr></table></div>
</li></ul>
<ul id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_ul10483163418288"><li id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_li1548317344280">安装rpmbuild：执行以下命令检查yum源中的rpmbuild的rpm包并安装。<div class="codecoloring" codetype="Bash" id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0229764399_zh-cn_topic_0212788399_screen17404204341017"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span></span>yum list <span class="p">|</span> grep rpm-build
yum install -y rpm-build
</pre></div>
</td></tr></table></div>
</li></ul>
<ul id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_ul1885210378287"><li id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_li28529374286">如果yum源中不存在rpmbuild的rpm包，请自行下载对应组件，并上传至服务器执行以下命令安装。<div class="codecoloring" codetype="Bash" id="ZH-CN_TOPIC_0222610840__zh-cn_topic_0228242418_zh-cn_topic_0229764399_zh-cn_topic_0212788399_screen081933451316"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>rpm -ivh xxx.rpm
</pre></div>
</td></tr></table></div>
</li></ul>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>父主题：</strong> <a href="zh-cn_topic_0000001191872229.html">FAQ</a></div>
</div>
</div>

<div class="hrcopyright"><hr size="2"></div><div class="hwcopyright">版权所有 &copy; 华为技术有限公司</div></body>
</html>