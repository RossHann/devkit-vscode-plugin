
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="zh-cn" xml:lang="zh-cn">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="topic">
<meta name="DC.Title" content="创建进程/线程性能分析任务">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="zh-cn_topic_0251208340.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="user guide">
<meta name="DC.Publisher" content="20210630">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="ZH-CN_TOPIC_0251208341">
<meta name="DC.Language" content="zh-cn">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<title>创建进程/线程性能分析任务</title>
</head>
<body style="clear:both; padding-left:10px; padding-top:5px; padding-right:5px; padding-bottom:5px"><a name="ZH-CN_TOPIC_0251208341"></a><a name="ZH-CN_TOPIC_0251208341"></a>

<h1 class="topictitle1">创建进程/线程性能分析任务</h1>
<div id="body1591010366918"><div class="section" id="ZH-CN_TOPIC_0251208341__section71672165013"><h4 class="sectiontitle">功能描述</h4><p id="ZH-CN_TOPIC_0251208341__p1533716474205">进程/线程性能分析借鉴业界的USE方法，采集进程/线程对CPU、内存、存储IO等资源的消耗情况，获得对应的使用率、饱和度、错误次数等指标，以此识别性能瓶颈。针对部分指标项，根据当前已有的基准值和优化经验提供优化建议。支持分析单个进程的系统调用情况。</p>
<div class="note" id="ZH-CN_TOPIC_0251208341__note3920123810526"><img src="public_sys-resources/note_3.0-zh-cn.png"><span class="notetitle"> </span><div class="notebody"><p id="ZH-CN_TOPIC_0251208341__p1992113815213">如果环境sysstat版本不高于11.0.0，进程/线程分析任务结果可能出现异常数据。</p>
</div></div>
</div>
<div class="section" id="ZH-CN_TOPIC_0251208341__section11470129119"><h4 class="sectiontitle">前提条件</h4><p id="ZH-CN_TOPIC_0251208341__zh-cn_topic_0250279620_p99642151324">已成功创建工程，且当前工程下不存在<span class="parmvalue" id="ZH-CN_TOPIC_0251208341__zh-cn_topic_0250279620_parmvalue11239184764819">“离线”</span>状态的节点。</p>
</div>
<div class="section" id="ZH-CN_TOPIC_0251208341__section04555504313"><h4 class="sectiontitle">操作步骤</h4><ol id="ZH-CN_TOPIC_0251208341__ol15971352649"><li id="ZH-CN_TOPIC_0251208341__li1440918227258"><span>单击工程列表中指定工程后面的<span><img id="ZH-CN_TOPIC_0251208341__zh-cn_topic_0250279620_image21541215171214" src="zh-cn_image_0252395926.png"></span>。</span><p><p id="ZH-CN_TOPIC_0251208341__zh-cn_topic_0250279620_p166122471044">打开“新建分析任务”页面。</p>
</p></li><li id="ZH-CN_TOPIC_0251208341__li15546205263216"><span>参考“任务管理”和<a href="#ZH-CN_TOPIC_0251208341__table657242932515">表1</a>配置任务参数。</span><p><div class="p" id="ZH-CN_TOPIC_0251208341__p18207353103211">以通用场景下创建的工程为例，新建进程/线程性能分析任务，如<a href="#ZH-CN_TOPIC_0251208341__fig13571102916256">图1</a>。<div class="fignone" id="ZH-CN_TOPIC_0251208341__fig13571102916256"><a name="ZH-CN_TOPIC_0251208341__fig13571102916256"></a><a name="fig13571102916256"></a><span class="figcap"><b>图1 </b>新建进程/线程性能分析任务（通用场景）</span><br><span><img id="ZH-CN_TOPIC_0251208341__image87081752482" src="zh-cn_image_0000001100748912.png"></span></div>

<div class="tablenoborder"><a name="ZH-CN_TOPIC_0251208341__table657242932515"></a><a name="table657242932515"></a><table cellpadding="4" cellspacing="0" summary="" id="ZH-CN_TOPIC_0251208341__table657242932515" frame="border" border="1" rules="all"><caption><b>表1 </b>新建进程/线程性能分析任务参数说明</caption><colgroup><col style="width:24.060000000000002%"><col style="width:75.94%"></colgroup><thead align="left"><tr id="ZH-CN_TOPIC_0251208341__row357182952518"><th align="left" class="cellrowborder" valign="top" width="24.060000000000002%" id="mcps1.3.3.2.2.2.1.3.2.3.1.1"><p id="ZH-CN_TOPIC_0251208341__p1257114294259">参数</p>
</th>
<th align="left" class="cellrowborder" valign="top" width="75.94%" id="mcps1.3.3.2.2.2.1.3.2.3.1.2"><p id="ZH-CN_TOPIC_0251208341__p8571182982510">说明</p>
</th>
</tr>
</thead>
<tbody><tr id="ZH-CN_TOPIC_0251208341__row4571122914252"><td class="cellrowborder" valign="top" width="24.060000000000002%" headers="mcps1.3.3.2.2.2.1.3.2.3.1.1 "><p id="ZH-CN_TOPIC_0251208341__p5571132915258">任务名称</p>
</td>
<td class="cellrowborder" valign="top" width="75.94%" headers="mcps1.3.3.2.2.2.1.3.2.3.1.2 "><p id="ZH-CN_TOPIC_0251208341__p7571102916252">输入分析任务的名称。名称需要满足如下要求：</p>
<ul id="ZH-CN_TOPIC_0251208341__ul1557102915252"><li id="ZH-CN_TOPIC_0251208341__zh-cn_topic_0250471713_li9539192134211">只能由字母、数字、特殊字符（@#$%^&amp;*()[]&lt;&gt;._-!~+空格）组成</li><li id="ZH-CN_TOPIC_0251208341__zh-cn_topic_0250471713_li1253911219425">长度为1~32个字符</li></ul>
</td>
</tr>
<tr id="ZH-CN_TOPIC_0251208341__row13571132914254"><td class="cellrowborder" valign="top" width="24.060000000000002%" headers="mcps1.3.3.2.2.2.1.3.2.3.1.1 "><p id="ZH-CN_TOPIC_0251208341__p257122917256">分析对象</p>
</td>
<td class="cellrowborder" valign="top" width="75.94%" headers="mcps1.3.3.2.2.2.1.3.2.3.1.2 "><p id="ZH-CN_TOPIC_0251208341__p145711729132511">选择“系统”或“应用”。</p>
</td>
</tr>
<tr id="ZH-CN_TOPIC_0251208341__row554110103414"><td class="cellrowborder" valign="top" width="24.060000000000002%" headers="mcps1.3.3.2.2.2.1.3.2.3.1.1 "><p id="ZH-CN_TOPIC_0251208341__p19541161018419">模式</p>
</td>
<td class="cellrowborder" valign="top" width="75.94%" headers="mcps1.3.3.2.2.2.1.3.2.3.1.2 "><p id="ZH-CN_TOPIC_0251208341__p05419106413">选择“Launch Application”或”Attach to Process“。</p>
<p id="ZH-CN_TOPIC_0251208341__p736721413479">分析对象选择“应用”时需配置此参数。</p>
</td>
</tr>
<tr id="ZH-CN_TOPIC_0251208341__row98314318415"><td class="cellrowborder" valign="top" width="24.060000000000002%" headers="mcps1.3.3.2.2.2.1.3.2.3.1.1 "><p id="ZH-CN_TOPIC_0251208341__p151743152118">应用路径</p>
</td>
<td class="cellrowborder" valign="top" width="75.94%" headers="mcps1.3.3.2.2.2.1.3.2.3.1.2 "><p id="ZH-CN_TOPIC_0251208341__p1772542511310">输入待分析应用的绝对路径。例如分析保存在“/home/test”目录下的“loop_test”应用，则输入：/home/test/loop_test</p>
<p id="ZH-CN_TOPIC_0251208341__p15584154362715">分析对象选择“应用”，模式选择“Launch Application”时需配置此参数。</p>
<div class="note" id="ZH-CN_TOPIC_0251208341__note9725162513132"><span class="notetitle"> 说明： </span><div class="notebody"><ul id="ZH-CN_TOPIC_0251208341__zh-cn_topic_0250422243_ul167258259137"><li id="ZH-CN_TOPIC_0251208341__zh-cn_topic_0250422243_li772513252139">默认分析“/opt/”或者“/home/”目录下的应用，管理员用户可在<span id="ZH-CN_TOPIC_0251208341__zh-cn_topic_0250422243_ph37251225181319">系统性能分析</span>首页中的<span><img id="ZH-CN_TOPIC_0251208341__zh-cn_topic_0250422243_image87251825161317" src="zh-cn_image_0293557353.png"></span>菜单选项中选择“系统配置”，手动配置“应用程序路径设置”，路径之间采用分号分隔。仅管理员用户可修改，普通用户只有查看权限。<p id="ZH-CN_TOPIC_0251208341__zh-cn_topic_0250422243_p1274014165718">应用程序路径建议配置为 “/home”、“/opt”等，请不要配置为“/”、“/dev”、“/sys”、“/boot”等系统目录，否则可能导致系统异常。</p>
</li><li id="ZH-CN_TOPIC_0251208341__zh-cn_topic_0250422243_li10725142551320">对于保存应用的目录，<span id="ZH-CN_TOPIC_0251208341__zh-cn_topic_0250422243_ph19726725151312">鲲鹏性能分析工具</span>程序的操作系统运行用户（<strong id="ZH-CN_TOPIC_0251208341__zh-cn_topic_0250422243_b6290143125311">launcher</strong>）对于待分析的应用需要有可读可执行权限。</li><li id="ZH-CN_TOPIC_0251208341__zh-cn_topic_0250422243_li16726425181310">多节点场景下，打开<span class="uicontrol" id="ZH-CN_TOPIC_0251208341__zh-cn_topic_0250422243_uicontrol2726125171314">“配置指定节点参数”</span>选项可单独配置各节点的该参数。</li></ul>
</div></div>
</td>
</tr>
<tr id="ZH-CN_TOPIC_0251208341__row1936719511131"><td class="cellrowborder" valign="top" width="24.060000000000002%" headers="mcps1.3.3.2.2.2.1.3.2.3.1.1 "><p id="ZH-CN_TOPIC_0251208341__p1066812252347">应用运行用户（可选）</p>
</td>
<td class="cellrowborder" valign="top" width="75.94%" headers="mcps1.3.3.2.2.2.1.3.2.3.1.2 "><p id="ZH-CN_TOPIC_0251208341__p38061351133414">分析对象选择“应用”，模式选择“Launch Application”时可以选择配置该参数，默认关闭。</p>
<ul id="ZH-CN_TOPIC_0251208341__ul102288814402"><li id="ZH-CN_TOPIC_0251208341__li82299816404">关闭状态：应用运行用户为系统默认用户launcher。</li><li id="ZH-CN_TOPIC_0251208341__li7746174220401">打开状态：应用运行用户为实际配置的用户。</li></ul>
</td>
</tr>
<tr id="ZH-CN_TOPIC_0251208341__row191491538174119"><td class="cellrowborder" valign="top" width="24.060000000000002%" headers="mcps1.3.3.2.2.2.1.3.2.3.1.1 "><p id="ZH-CN_TOPIC_0251208341__p11275657101116">应用参数 (可选)</p>
</td>
<td class="cellrowborder" valign="top" width="75.94%" headers="mcps1.3.3.2.2.2.1.3.2.3.1.2 "><p id="ZH-CN_TOPIC_0251208341__p109821355135">输入应用参数，请根据实际应用场景填写。</p>
<p id="ZH-CN_TOPIC_0251208341__p16672195202817">分析对象选择“应用”，模式选择“Launch Application”时需配置此参数。</p>
<div class="note" id="ZH-CN_TOPIC_0251208341__note0982143510137"><span class="notetitle"> 说明： </span><div class="notebody"><p id="ZH-CN_TOPIC_0251208341__p198273513138">打开<span class="uicontrol" id="ZH-CN_TOPIC_0251208341__uicontrol1498253541317">“配置指定节点参数”</span>时各节点可单独配置该参数。</p>
</div></div>
</td>
</tr>
<tr id="ZH-CN_TOPIC_0251208341__row105761899516"><td class="cellrowborder" valign="top" width="24.060000000000002%" headers="mcps1.3.3.2.2.2.1.3.2.3.1.1 "><p id="ZH-CN_TOPIC_0251208341__p95761799515">进程名</p>
</td>
<td class="cellrowborder" valign="top" width="75.94%" headers="mcps1.3.3.2.2.2.1.3.2.3.1.2 "><p id="ZH-CN_TOPIC_0251208341__p1316722135218">输入进程名称，进程名称支持输入正则表达式。</p>
<p id="ZH-CN_TOPIC_0251208341__p14801122212284">分析对象选择“应用”，模式选择“Attach to Process”时需配置此参数。</p>
</td>
</tr>
<tr id="ZH-CN_TOPIC_0251208341__row209711233104818"><td class="cellrowborder" valign="top" width="24.060000000000002%" headers="mcps1.3.3.2.2.2.1.3.2.3.1.1 "><p id="ZH-CN_TOPIC_0251208341__p21419198119">PID</p>
</td>
<td class="cellrowborder" valign="top" width="75.94%" headers="mcps1.3.3.2.2.2.1.3.2.3.1.2 "><p id="ZH-CN_TOPIC_0251208341__p13514164581316">输入要分析的进程的PID，最多输入10个，中间用英文逗号分割。PID和进程名可以同时配置。</p>
<p id="ZH-CN_TOPIC_0251208341__p93263882820">分析对象选择“应用”，模式选择“Attach to Process”时需配置此参数。</p>
<div class="note" id="ZH-CN_TOPIC_0251208341__note1351413456132"><span class="notetitle"> 说明： </span><div class="notebody"><ul id="ZH-CN_TOPIC_0251208341__zh-cn_topic_0250422243_ul11514745101316"><li id="ZH-CN_TOPIC_0251208341__zh-cn_topic_0250422243_li85141245121316">“Attach to Process” 针对正在运行的应用程序（<span id="ZH-CN_TOPIC_0251208341__zh-cn_topic_0250422243_ph12514184521311">鲲鹏性能分析工具</span>程序的操作系统运行用户（<strong id="ZH-CN_TOPIC_0251208341__zh-cn_topic_0250422243_b18892174953213">launcher</strong>）针对运行的应用程序需要有可读权限），通过关联到运行该应用程序的PID的方式，来实时跟踪和采集该应用程序的性能数据。</li><li id="ZH-CN_TOPIC_0251208341__zh-cn_topic_0250422243_li15514194511312">进程的PID可执行<strong id="ZH-CN_TOPIC_0251208341__zh-cn_topic_0250422243_b2514124501312">ps -ef | grep</strong> <em id="ZH-CN_TOPIC_0251208341__zh-cn_topic_0250422243_i651474517133">程序名称</em>查询。</li><li id="ZH-CN_TOPIC_0251208341__zh-cn_topic_0250422243_li1951417459130">打开<span class="uicontrol" id="ZH-CN_TOPIC_0251208341__zh-cn_topic_0250422243_uicontrol17515154571317">“配置指定节点参数”</span>时各节点可单独配置该参数。</li></ul>
</div></div>
</td>
</tr>
<tr id="ZH-CN_TOPIC_0251208341__row657114292254"><td class="cellrowborder" valign="top" width="24.060000000000002%" headers="mcps1.3.3.2.2.2.1.3.2.3.1.1 "><p id="ZH-CN_TOPIC_0251208341__p1357152972518">分析类型</p>
</td>
<td class="cellrowborder" valign="top" width="75.94%" headers="mcps1.3.3.2.2.2.1.3.2.3.1.2 "><p id="ZH-CN_TOPIC_0251208341__p16571329142517">选择“进程/线程性能分析”。</p>
</td>
</tr>
<tr id="ZH-CN_TOPIC_0251208341__row135711029132510"><td class="cellrowborder" valign="top" width="24.060000000000002%" headers="mcps1.3.3.2.2.2.1.3.2.3.1.1 "><p id="ZH-CN_TOPIC_0251208341__p1457122992512">采样时长 (s)</p>
</td>
<td class="cellrowborder" valign="top" width="75.94%" headers="mcps1.3.3.2.2.2.1.3.2.3.1.2 "><p id="ZH-CN_TOPIC_0251208341__p85711829112518">设置采样的时间。默认为60秒，取值范围2~300秒。</p>
</td>
</tr>
<tr id="ZH-CN_TOPIC_0251208341__row45716294253"><td class="cellrowborder" valign="top" width="24.060000000000002%" headers="mcps1.3.3.2.2.2.1.3.2.3.1.1 "><p id="ZH-CN_TOPIC_0251208341__p1857142922516">采样间隔 (s)</p>
</td>
<td class="cellrowborder" valign="top" width="75.94%" headers="mcps1.3.3.2.2.2.1.3.2.3.1.2 "><p id="ZH-CN_TOPIC_0251208341__p1157142942512">设置采样间隔，默认为1秒，取值范围1~10秒。</p>
<div class="note" id="ZH-CN_TOPIC_0251208341__note1857112293256"><span class="notetitle"> 说明： </span><div class="notebody"><p id="ZH-CN_TOPIC_0251208341__p13571132922513">“采样间隔”应当小于或等于“采样时长”的1/2。</p>
</div></div>
</td>
</tr>
<tr id="ZH-CN_TOPIC_0251208341__row19572162911250"><td class="cellrowborder" valign="top" width="24.060000000000002%" headers="mcps1.3.3.2.2.2.1.3.2.3.1.1 "><p id="ZH-CN_TOPIC_0251208341__p2057112911250">采样类型</p>
</td>
<td class="cellrowborder" valign="top" width="75.94%" headers="mcps1.3.3.2.2.2.1.3.2.3.1.2 "><p id="ZH-CN_TOPIC_0251208341__p17571152911257">选择需要采集的类型。可选择：</p>
<ul id="ZH-CN_TOPIC_0251208341__ul15572529172520"><li id="ZH-CN_TOPIC_0251208341__li19572112916256">CPU</li><li id="ZH-CN_TOPIC_0251208341__li157272917251">内存</li><li id="ZH-CN_TOPIC_0251208341__li957215299256">存储IO</li><li id="ZH-CN_TOPIC_0251208341__li357211292253">上下文切换</li></ul>
</td>
</tr>
<tr id="ZH-CN_TOPIC_0251208341__row9572132915259"><td class="cellrowborder" valign="top" width="24.060000000000002%" headers="mcps1.3.3.2.2.2.1.3.2.3.1.1 "><p id="ZH-CN_TOPIC_0251208341__p16572829162517">采集线程信息</p>
</td>
<td class="cellrowborder" valign="top" width="75.94%" headers="mcps1.3.3.2.2.2.1.3.2.3.1.2 "><p id="ZH-CN_TOPIC_0251208341__p19572129172518">是否采集线程信息。默认打开。</p>
</td>
</tr>
<tr id="ZH-CN_TOPIC_0251208341__row14548115718374"><td class="cellrowborder" valign="top" width="24.060000000000002%" headers="mcps1.3.3.2.2.2.1.3.2.3.1.1 "><p id="ZH-CN_TOPIC_0251208341__p106029243814">跟踪系统调用</p>
</td>
<td class="cellrowborder" valign="top" width="75.94%" headers="mcps1.3.3.2.2.2.1.3.2.3.1.2 "><p id="ZH-CN_TOPIC_0251208341__p46364723814">是否采集应用程序在Linux系统下系统函数调用的信息。默认关闭。</p>
<p id="ZH-CN_TOPIC_0251208341__p1857584915284">分析对象选择“应用”时需配置此参数。</p>
<div class="note" id="ZH-CN_TOPIC_0251208341__note206364743813"><span class="notetitle"> 说明： </span><div class="notebody"><p id="ZH-CN_TOPIC_0251208341__p146561551134013">对于某些系统调用频繁的应用程序，开启跟踪系统调用会导致系统性能大幅度下降，不建议在生产环境上使用。</p>
</div></div>
</td>
</tr>
<tr id="ZH-CN_TOPIC_0251208341__row175729292259"><td class="cellrowborder" valign="top" width="24.060000000000002%" headers="mcps1.3.3.2.2.2.1.3.2.3.1.1 "><p id="ZH-CN_TOPIC_0251208341__p7572102922520">预约定时启动</p>
</td>
<td class="cellrowborder" valign="top" width="75.94%" headers="mcps1.3.3.2.2.2.1.3.2.3.1.2 "><p id="ZH-CN_TOPIC_0251208341__p3572129172511">是否创建预约定时启动任务，详细信息请参考<a href="zh-cn_topic_0250471713.html">任务管理</a>。</p>
<p id="ZH-CN_TOPIC_0251208341__p1051717122510">设置应用运行用户参数后不能预约定时启动任务，该功能置灰。</p>
</td>
</tr>
<tr id="ZH-CN_TOPIC_0251208341__row3572429122512"><td class="cellrowborder" valign="top" width="24.060000000000002%" headers="mcps1.3.3.2.2.2.1.3.2.3.1.1 "><p id="ZH-CN_TOPIC_0251208341__p657262916251">立即执行</p>
</td>
<td class="cellrowborder" valign="top" width="75.94%" headers="mcps1.3.3.2.2.2.1.3.2.3.1.2 "><p id="ZH-CN_TOPIC_0251208341__p145721829172514">任务创建完成后会自动开始执行，默认勾选。</p>
<p id="ZH-CN_TOPIC_0251208341__p117794819514">设置应用运行用户参数，任务只能立即执行，该功能强制勾选，置灰显示。</p>
<div class="note" id="ZH-CN_TOPIC_0251208341__note13572129102516"><span class="notetitle"> 说明： </span><div class="notebody"><p id="ZH-CN_TOPIC_0251208341__zh-cn_topic_0250471713_p15450171572414">打开“预约定时启动”将不显示该选项。</p>
</div></div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
</p></li><li id="ZH-CN_TOPIC_0251208341__li92471127563"><span>单击“确认”完成分析任务的创建。</span><p><p id="ZH-CN_TOPIC_0251208341__p891613712436">单击任务名称后面对应的图标可以执行如下操作：</p>
</p></li></ol>
</div>
</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>父主题：</strong> <a href="zh-cn_topic_0251208340.html">进程/线程性能分析</a></div>
</div>
</div>

<div class="hrcopyright"><hr size="2"></div><div class="hwcopyright">版权所有 &copy; 华为技术有限公司</div></body>
</html>