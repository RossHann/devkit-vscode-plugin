
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="topic">
<meta name="DC.Title" content="Configuring the SPE Environment">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="en-us_topic_0000001223882725.html">
<meta name="prodname" content="">
<meta name="version" content="2.3.0">
<meta name="brand" content="Kunpeng Hyper Tuner (Diagnosis and Debugging)">
<meta name="DC.Publisher" content="20211230">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_TOPIC_0000001224361215">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="public_sys-resources/commonltr.css">
<title>Configuring the SPE Environment</title>
</head>
<body style="clear:both; padding-left:10px; padding-top:5px; padding-right:5px; padding-bottom:5px"><a name="EN-US_TOPIC_0000001224361215"></a><a name="EN-US_TOPIC_0000001224361215"></a>

<h1 class="topictitle1">Configuring the SPE Environment</h1>
<div id="body8662426"><div class="section" id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_section10499203964318"><h4 class="sectiontitle">Configuring the SPE Environment for openEuler</h4><div class="note" id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_note080913701518"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_p380953710150">TaiShan 200 series servers support the SPE function in BIOS since V159.</p>
</div></div>
<ol id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_ol6644111294420"><li id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_li1629718335112"><span>Check the status of <strong id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_b173028386504">MISC Config--&gt; SPE</strong> in the BIOS. If the status is <strong id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_b1652294625012">Disabled</strong>, change it to <strong id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_b3331174925015">Enabled</strong>.</span><p><p id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_p118104461313"><span><img id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_image37114420134" src="en-us_image_0000001224201507.png"></span></p>
</p></li><li id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_li2644121219445"><span>Use an SSH remote login tool to log in to the Linux CLI as the root user.</span></li><li id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_li4644101254416"><span>Configure system boot parameters.</span><p><ol type="a" id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_ol1564491219441"><li id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_li364451234417">Run the following command to edit the configuration file:<p id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_p664481215444"><a name="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_li364451234417"></a><a name="en-us_topic_0000001163108951_en-us_topic_0277824914_li364451234417"></a><strong id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_b564491218447">vim /etc/grub2-efi.cfg</strong></p>
</li><li id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_li1464415122442">Locate the boot option corresponding to the kernel version and add <strong id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_b1724903925115">kpti=off</strong> at the end of the option.<pre class="screen" id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_screen66441812164413">        linux   /vmlinuz-4.19.90-2003.4.0.0036.oe1.aarch64 root=/dev/mapper/openeuler-root ro rd.lvm.lv=openeuler/root rd.lvm.lv=openeuler/swap video=VGA-1:640x480-32@60me rhgb quiet  smmu.bypassdev=0x1000:0x17 smmu.bypassdev=0x1000:0x15 crashkernel=1024M,high video=efifb:off video=VGA-1:640x480-32@60me <strong id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_b12644121219445">kpti=off</strong></pre>
<div class="notice" id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_note386595195513"><span class="noticetitle"><img src="public_sys-resources/notice_3.0-en-us.png"> </span><div class="noticebody"><p id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_p118654519558">Setting <strong id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_b14821492011">kpti</strong> to <strong id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_b34821491516">off</strong> poses security risks. Do not run the tool on the production environment. </p>
</div></div>
</li><li id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_li664491224415">Press <strong id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_b1266515581519">Esc</strong>, type <strong id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_b10670135810511">:wq</strong>, and press <strong id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_b5670135810515">Enter</strong> to save the settings and exit.</li><li id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_li10644191210447">Run the <strong id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_b63314617524">reboot</strong> command to restart the server.</li></ol>
</p></li><li id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_li164410122444"><span>After installing the Kunpeng Hyper Tuner, run the following command to check whether the SPE function is enabled:</span><p><p id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_p6644101294411"><strong id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_b764414122441">perf list | grep arm_spe</strong></p>
<p id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_p96448126447">If the following information is displayed, the SPE function is enabled.</p>
<pre class="screen" id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_screen1364411218446">arm_spe_0//                                        [Kernel PMU event]</pre>
</p></li></ol>
</div>
<div class="section" id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_section2960152112443"><h4 class="sectiontitle">Configuring the SPE Environment for CentOS 7.6</h4><div class="note" id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_note15780114911616"><img src="public_sys-resources/note_3.0-en-us.png"><span class="notetitle"> </span><div class="notebody"><p id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_p16786144901620">TaiShan 200 series servers support the SPE function in BIOS since V159.</p>
</div></div>
<ol id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_ol15449191616206"><li id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_li114821120131615"><span>Check the status of <strong id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_b1426414218512">MISC Config--&gt; SPE</strong> in the BIOS. If the status is <strong id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_b172706255118">Disabled</strong>, change it to <strong id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_b20270102155114">Enabled</strong>.</span><p><p id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_p17748164031615"><span><img id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_image207481040201615" src="en-us_image_0000001224122935.png"></span></p>
</p></li><li id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_li181151529193613"><span>Use an SSH remote login tool to log in to the Linux CLI as the root user.</span></li><li id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_li3449191672010"><span>Configure system boot parameters.</span><p><ol type="a" id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_ol12449151662019"><li id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_li4449151614201">Run the following command to edit the configuration file:<p id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_p164491916112012"><a name="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_li4449151614201"></a><a name="en-us_topic_0000001163108951_en-us_topic_0277824914_li4449151614201"></a><strong id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_b114491116152020">vim /boot/efi/EFI/centos/grub.cfg</strong></p>
</li><li id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_li7449201672015">Locate the boot option corresponding to the kernel version and add <strong id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_b490768690">kpti=off</strong> at the end of the option.<pre class="screen" id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_screen18602325174011">        linux   /vmlinuz-4.14.0-115.el7a.0.1.aarch64 root=/dev/mapper/centos-root ro crashkernel=auto rd.lvm.lv=centos/root rd.lvm.lv=centos/swap rhgb quiet LANG=en_US.UTF-8 <strong id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_b116911132144011">kpti=off</strong></pre>
<div class="notice" id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_note181471612580"><span class="noticetitle"><img src="public_sys-resources/notice_3.0-en-us.png"> </span><div class="noticebody"><p id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_p198141516205813">Setting <strong id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_b27094612317">kpti</strong> to <strong id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_b1071714613311">off</strong> poses security risks. Do not run the tool on the production environment. </p>
</div></div>
</li><li id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_li132444902417">Press <strong id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_b619672374">Esc</strong>, type <strong id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_b1201185695">:wq</strong>, and press <strong id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_b933032579">Enter</strong> to save the settings and exit.</li><li id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_li65131322181512">Run the <strong id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_b115158919319">reboot</strong> command to restart the server.</li><li id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_li148901320104818">Run the following command to obtain system boot parameters and check whether <strong id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_b192791538171711">kpti=off</strong> is successfully added:<p id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_p1773072114486"><strong id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_b2083522417484">cat /proc/cmdline</strong></p>
</li></ol>
</p></li><li id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_li145091124354"><span>After installing the Kunpeng Hyper Tuner, run the following command to check whether the SPE function is enabled:</span><p><p id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_p950941213518"><strong id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_b45097127358">perf list | grep arm_spe</strong></p>
<p id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_p175096127351">If the following information is displayed, the SPE function is enabled.</p>
<pre class="screen" id="EN-US_TOPIC_0000001224361215__en-us_topic_0000001163108951_en-us_topic_0277824914_screen938413164353">arm_spe_0//                                        [Kernel PMU event]</pre>
</p></li></ol>
</div>
</div>
<div>
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a href="en-us_topic_0000001223882725.html">Common Operations</a></div>
</div>
</div>

<div class="hrcopyright"><hr size="2"></div><div class="hwcopyright">Copyright &copy; Huawei Technologies Co., Ltd.</div></body>
</html>