<!-- 点击button后出现模板 -->
<div class="template-all-content configItemBox">
  <div class="header boxHeader">
    <div class="title">{{ i18n.mission_modal.missionTemplate }}</div>
  </div>

  <div class="boxMain" [appLoading]="isLoading">
    <div *ngIf="srcData.data.length !== 0">
      <button class="delete" tiButton type="button" (click)="multipleDelete()" [disabled]='checkedList.length == 0'>
        {{ i18n.mission_modal.batchDelete }}
      </button>
    </div>

    <div class="templateList">
      <div class="table">
        <ti-table [(displayedData)]="displayed" [srcData]="srcData" [columns]="columns">
          <div class="ti3-table-fixed-head">
            <table>
              <thead>
                <tr>
                  <!--使用复选框时，需要给复选框列加 checkbox-column 属性-->
                  <th details-icon-column width='5%'></th>
                  <th checkbox-column *ngIf="srcData.data.length !== 0" width='5%'>
                    <!--全选按钮-->
                    <!--如果有分页，全选需要控制当前页时，items接口传入displayed
                      如果全选要控制表格所有数据，items接口传入srcData.data-->
                    <input type="checkbox" tiCheckgroup [items]="srcData.data" [(checkeds)]="checkedList" />
                  </th>
                  <ng-container *ngFor="let column of columns;index as i;">
                    <th width="{{column.width}}" *ngIf=" i > 0 && i < 3">
                      <ti-cell-text>{{column.title}}</ti-cell-text>
                      <div class="filter-box" *ngIf="!isDiagnose">
                        <img src="./assets/img/header/filter.png" alt="">
                        <div class="filter-box-list">
                          <span *ngFor="let item of column.options">
                            <input type="checkbox" tiCheckitem [item]="item" [beCheckeds]="column.selected"
                              [label]="item.text" (change)="onMyChange($event,i)">
                          </span>
                        </div>
                      </div>
                    </th>
                    <th *ngIf="i == 0 || i > 2" tiOverflow width="{{column.width}}">{{column.title}}</th>
                  </ng-container>
                </tr>
              </thead>
            </table>
          </div>
          <!--.ti3-table-container是表体的容器，它的子元素中的table的thead是用来控制各列宽度，实际不显示；tbody是实际显示的表体-->
          <!--注意1:此处一定要使用.ti3-table-container样式类-->
          <!--注意2:用户在有.ti3-table-container样式类的容器上来设置表体的高度或最大高度-->
          <div class="ti3-table-container" [ngClass]="{noDataHeight: displayed.length === 0}">
            <table>
              <thead>
                <tr>
                  <th details-icon-column width='5%'></th>
                  <th checkbox-column *ngIf="srcData.data.length !== 0" width='5%'></th>
                  <!--此处的表头是用来控制各列宽度，实际不显示，所以注意 th 标签内部不要嵌套任何内容。-->
                  <th *ngFor="let column of columns" width="{{column.width}}"></th>
                </tr>
              </thead>

              <tbody>
                <!--注意:ngFor中的displayed数据与displayedData传入的数据一致, 初始化设置为[]即可-->
                <ng-container *ngFor="let obj of displayed;index as i;trackBy: trackByFn">
                  <tr>
                    <td details-icon-column>
                      <ti-details-icon [row]="obj" [index]="i" (beforeToggle)="beforeToggle($event,i)">
                      </ti-details-icon>
                      <!--详情图标设置，传入行数据-->
                    </td>
                    <td checkbox-column *ngIf="srcData.data.length !== 0">
                      <input type="checkbox" tiCheckitem [item]="obj" />
                    </td>
                    <td tiOverflow>{{ obj.templateName }}</td>
                    <td tiOverflow>{{ obj.analysisTargetText }}</td>
                    <td tiOverflow *ngIf="!isDiagnose">{{ obj.analysisType }}</td>
                    <td>
                      <span style="color:#0067ff;cursor: pointer;"
                        (click)="delete(obj)">{{i18n.mission_modal.delete}}</span>
                    </td>
                  </tr>
                  <tr *tiDetailsTr="obj" class="tiDetailsTr template" [ngClass]="{'active': obj.showDetails}">
                    <!--详情内容行tiDetailsTr，传入行数据-->
                    <!-- tiColspan是为了使得该td（详情内容）占据表格整个宽度(列合并)，tiColspan列合并的值为columns接口传入的对象数组中
                        中show属性值不为false的对象的个数。本例中，作用相当于colspan='6' -->
                    <td colspan="6" class="collapsed">
                      <!-- 函数分析任务模板 c-cpp-program 2-->
                      <div class="table" *ngIf="obj['analysis-type'] === missArr[0]">
                        <div class="table-left">
                          <ul *ngIf="obj['analysis-target'] === cPs">
                            <li *ngFor="let obje of missionDetail[0][0]">
                              <p>{{ obje.calcTitle ? obje.calcTitle(obj) : obje.title }}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ i18n.preSwitch.colectMethods }}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ i18n.preSwitch.pointTime }}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ i18n.preSwitch.pointDuration }}</p>
                            </li>
                          </ul>
                          <ul *ngIf="obj['analysis-target'] === cAtp">
                            <li *ngFor="let obje of missionDetail[0][1]">
                              <p>{{ obje.calcTitle ? obje.calcTitle(obj) : obje.title }}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ i18n.preSwitch.colectMethods }}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ i18n.preSwitch.pointTime }}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ i18n.preSwitch.pointDuration }}</p>
                            </li>
                          </ul>
                          <ul *ngIf="obj['analysis-target'] === cLa">
                            <li *ngFor="let obje of missionDetail[0][2]">
                              <p>{{ obje.calcTitle ? obje.calcTitle(obj) : obje.title }}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ i18n.preSwitch.colectMethods }}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ i18n.preSwitch.pointTime }}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ i18n.preSwitch.pointDuration }}</p>
                            </li>
                          </ul>
                        </div>
                        <div class="table-right">
                          <ul>
                            <li>
                              <p>
                                {{ obj["taskname"]}}
                              </p>
                            </li>
                            <li>
                              <p>
                                {{ obj["analysis-target"] }}
                              </p>
                            </li>
                            <li>
                              <p *ngIf="obj['analysis-target'] === cPs">
                                {{ (obj["duration"] || '--') | thousandSeparator }}
                              </p>
                            </li>
                            <li>
                              <p *ngIf="obj['analysis-target'] === cAtp">
                                {{ obj["process_name"] || '--' }}
                              </p>
                            </li>
                            <li>
                              <p *ngIf="obj['analysis-target'] === cAtp">
                                {{ obj["target-pid"] || '--' }}
                              </p>
                            </li>
                            <li>
                              <p *ngIf="obj['analysis-target'] === cAtp">
                                {{ (obj["duration"] || '--') | thousandSeparator }}
                              </p>
                            </li>
                            <li>
                              <p *ngIf="obj['analysis-target'] === cLa">
                                {{ obj["app-dir"] || '--' }}
                              </p>
                            </li>
                            <li>
                              <p *ngIf="obj['analysis-target'] === cLa">
                                {{ obj["app-parameters"] || '--' }}
                              </p>
                            </li>

                            <li>
                              <p [innerHTML]="
                              obj['interval'] === '0.71' ? 710 : obj['interval'] | thousandSeparator
                            ">
                                {{ (obj["interval"] || '--') | thousandSeparator }}
                              </p>
                            </li>
                            <li>
                              <p>
                                {{ getCorJavaType(obj["samplingSpace"].id) || '--' }}
                              </p>
                            </li>
                            <li>
                              <p *ngIf="obj['analysis-target'] === cPs">
                                {{ obj["cpu-mask"] || '--' }}
                              </p>
                            </li>
                            <li>
                              <p>{{ obj["assemblyLocation"] || '--' }}</p>
                            </li>
                            <li>
                              <p>{{ obj["sourceLocation"] || '--' }}</p>
                            </li>
                            <li>
                              <p>{{ obj.kcore ? i18n.process.enable : i18n.process.disable }}</p>
                            </li>
                            <li>
                              <p>
                                {{ obj["size"] || '--' }}
                              </p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>
                                {{
                                obj["cycle"]
                                ? i18n.preSwitch.duraColect
                                : i18n.preSwitch.onceColect
                                }}
                              </p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ obj["targetTime"] }}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ handleColectDate(obj) }}</p>
                            </li>
                          </ul>
                        </div>
                        <!-- panel -->
                        <div *ngIf="obj.switch">
                          <div *ngFor="let item of obj.nodeConfig">
                            <app-mission-panel [title]="item.nodeName + '(' + item.nodeIp + ')'" [active]="false">
                              <div class="content-box">
                                <div class="content-list" *ngIf="
                                item.task_param['analysis-target'].indexOf(
                                  'Profile'
                                ) !== -1
                              ">
                                  <div class="lable-right">
                                    <p class="label">
                                      {{ i18n.ddr.cpuToBeSamples }}
                                    </p>
                                    <p>{{ item.task_param['cpu-mask'] || '--' }}</p>
                                  </div>
                                  <div class="lable-right">
                                    <p class="label">
                                      {{ i18n.mission_modal.cProcess.file_path }}
                                    </p>
                                    <p>{{ item.task_param.assemblyLocation || '--' }}</p>
                                  </div>
                                  <div class="lable-right">
                                    <p class="label">
                                      {{ i18n.mission_modal.cProcess.source_path }}
                                    </p>
                                    <p>{{ item.task_param.sourceLocation || '--' }}</p>
                                  </div>
                                </div>
                                <div class="content-list" *ngIf="
                                item.task_param['analysis-target'].indexOf(
                                  'Launch'
                                ) !== -1
                              ">
                                  <div class="lable-right">
                                    <p class="label">
                                      {{ i18n.mission_modal.cProcess.app_path }}
                                    </p>
                                    <p>{{ item.task_param["app-dir"] || '--' }}</p>
                                  </div>
                                  <div class="lable-right">
                                    <p class="label">
                                      {{ i18n.mission_modal.cProcess.app_params }}
                                    </p>
                                    <p>{{ item.task_param["app-parameters"] || '--' }}</p>
                                  </div>
                                  <div class="lable-right">
                                    <p class="label">
                                      {{ i18n.mission_modal.cProcess.file_path }}
                                    </p>
                                    <p>{{ item.task_param.assemblyLocation || '--' }}</p>
                                  </div>
                                  <div class="lable-right">
                                    <p class="label">
                                      {{ i18n.mission_modal.cProcess.source_path }}
                                    </p>
                                    <p>{{ item.task_param.sourceLocation || '--' }}</p>
                                  </div>
                                </div>
                                <div class="content-list" *ngIf="
                                item.task_param['analysis-target'].indexOf(
                                  'Attach'
                                ) !== -1
                              ">
                                  <div class="lable-right">
                                    <p class="label">
                                      {{ i18n.mission_create.process_alias }}
                                    </p>
                                    <p>{{ item.task_param["process_name"] || '--' }}</p>
                                  </div>
                                  <div class="lable-right">
                                    <p class="label">
                                      {{ i18n.common_term_task_crate_pid }}
                                    </p>
                                    <p>{{ item.task_param["target-pid"] || '--' }}</p>
                                  </div>
                                  <div class="lable-right">
                                    <p class="label">
                                      {{ i18n.mission_modal.cProcess.file_path }}
                                    </p>
                                    <p>{{ item.task_param.assemblyLocation || '--' }}</p>
                                  </div>
                                  <div class="lable-right">
                                    <p class="label">
                                      {{ i18n.mission_modal.cProcess.source_path }}
                                    </p>
                                    <p>{{ item.task_param.sourceLocation || '--' }}</p>
                                  </div>
                                </div>
                              </div>
                            </app-mission-panel>
                          </div>
                        </div>
                      </div>
                      <!-- 锁与等待分析任务模板 lock 3 -->
                      <div class="table" *ngIf="obj['analysis-type'] === missArr[6]">
                        <div class="table-left">
                          <ul *ngIf="obj['analysis-target'] === cPs">
                            <li *ngFor="let obje of missionDetail[6][0]">
                              <p>{{ obje.calcTitle ? obje.calcTitle(obj) : obje.title }}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ i18n.preSwitch.colectMethods }}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ i18n.preSwitch.pointTime }}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ i18n.preSwitch.pointDuration }}</p>
                            </li>
                          </ul>
                          <ul *ngIf="obj['analysis-target'] === cAtp">
                            <li *ngFor="let obje of missionDetail[6][1]">
                              <p>{{ obje.calcTitle ? obje.calcTitle(obj) : obje.title }}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ i18n.preSwitch.colectMethods }}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ i18n.preSwitch.pointTime }}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ i18n.preSwitch.pointDuration }}</p>
                            </li>
                          </ul>
                          <ul *ngIf="obj['analysis-target'] === cLa">
                            <li *ngFor="let obje of missionDetail[6][2]">
                              <p>{{ obje.calcTitle ? obje.calcTitle(obj) : obje.title }}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ i18n.preSwitch.colectMethods }}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ i18n.preSwitch.pointTime }}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ i18n.preSwitch.pointDuration }}</p>
                            </li>
                          </ul>
                        </div>
                        <div class="table-right">
                          <ul>
                            <li>
                              <p>
                                {{ obj["taskname"]}}
                              </p>
                            </li>
                            <li>
                              <p>
                                {{ obj["analysis-target"] }}
                              </p>
                            </li>
                            <li>
                              <p *ngIf="obj['analysis-target'] === cPs">
                                {{ obj["duration"] | thousandSeparator}}
                              </p>
                            </li>

                            <li>
                              <p *ngIf="obj['analysis-target'] === cAtp">
                                {{ obj["target-pid"] || '--' }}
                              </p>
                            </li>
                            <li>
                              <p *ngIf="obj['analysis-target'] === cAtp">
                                {{ obj["process_name"] || '--' }}
                              </p>
                            </li>
                            <li>
                              <p *ngIf="obj['analysis-target'] === cAtp">
                                {{ (obj["duration"] || '--') | thousandSeparator }}
                              </p>
                            </li>

                            <li>
                              <p *ngIf="obj['analysis-target'] === cLa">
                                {{ obj["app-dir"] || '--' }}
                              </p>
                            </li>
                            <li>
                              <p *ngIf="obj['analysis-target'] === cLa">
                                {{ obj["app-parameters"] || '--' }}
                              </p>
                            </li>
                            <li>
                              <p [innerHTML]="
                              obj['interval'] === '0.71' ? 710 : obj['interval'] | thousandSeparator
                            ">
                                {{ obj["interval"] | thousandSeparator}}
                              </p>
                            </li>
                            <li>
                              <p>{{ getLockType(obj["collect_range"]) }}</p>
                            </li>
                            <li>
                              <p [tiTip]='obj["functionname"] ? obj["functionname"].split("^_{,2}").join("") : "--"'>
                                {{ obj["functionname"] ? obj["functionname"].split('^_{,2}').join('') : '--' }}
                              </p>
                            </li>
                            <li>
                              <p>{{ obj["assemblyLocation"] || '--' }}</p>
                            </li>
                            <li>
                              <p>{{ obj["sourceLocation"] || '--' }}</p>
                            </li>
                            <li>
                              <p>{{ obj.kcore ? i18n.process.enable : i18n.process.disable }}</p>
                            </li>
                            <li>
                              <p>{{ obj["collect_file_size"] || '--' }}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>
                                {{
                                obj["cycle"]
                                ? i18n.preSwitch.duraColect
                                : i18n.preSwitch.onceColect
                                }}
                              </p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ obj["targetTime"] }}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ handleColectDate(obj) }}</p>
                            </li>

                          </ul>
                        </div>
                        <!-- panel -->
                        <div *ngIf="obj.switch">
                          <div *ngFor="let item of obj.nodeConfig">
                            <app-mission-panel [title]="item.nodeName + '(' + item.nodeIp + ')'" [active]="false">
                              <div class="content-box">
                                <div class="content-list" *ngIf="
                                item.task_param['analysis-target'].indexOf(
                                  'Profile'
                                ) !== -1
                              ">
                                  <div class="lable-right">
                                    <p class="label">
                                      {{ i18n.mission_modal.lockSummary.filname }}
                                    </p>
                                    <p>{{ item.task_param.sourceLocation || '--' }}</p>
                                  </div>
                                  <div class="lable-right">
                                    <p class="label">
                                      {{ i18n.mission_modal.sysSource.source_path }}
                                    </p>
                                    <p>{{ item.task_param.assemblyLocation || '--' }}</p>
                                  </div>
                                </div>
                                <div class="content-list" *ngIf="
                                item.task_param['analysis-target'].indexOf(
                                  'Launch'
                                ) !== -1
                              ">
                                  <div class="lable-right">
                                    <p class="label">
                                      {{ missionDetail[6][2][0].title }}
                                    </p>
                                    <p>{{ item.task_param["app-dir"] || '--' }}</p>
                                  </div>
                                  <div class="lable-right">
                                    <p class="label">
                                      {{ missionDetail[6][2][1].title }}
                                    </p>
                                    <p>{{ item.task_param["app-parameters"] || '--' }}</p>
                                  </div>
                                  <div class="lable-right">
                                    <p class="label">
                                      {{ i18n.mission_modal.lockSummary.filname }}
                                    </p>
                                    <p>{{ item.task_param.sourceLocation || '--' }}</p>
                                  </div>
                                  <div class="lable-right">
                                    <p class="label">
                                      {{ i18n.mission_modal.sysSource.source_path }}
                                    </p>
                                    <p>{{ item.task_param.assemblyLocation || '--' }}</p>
                                  </div>
                                </div>
                                <div class="content-list" *ngIf="
                                item.task_param['analysis-target'].indexOf(
                                  'Attach'
                                ) !== -1
                              ">
                                  <div class="lable-right">
                                    <p class="label">{{ i18n.mission_modal.sysSource.pid }}</p>
                                    <p>{{ item.task_param["target-pid"] || '--' }}</p>
                                  </div>
                                  <div class="lable-right">
                                    <p class="label">{{ i18n.mission_create.process_alias }}</p>
                                    <p>{{ item.task_param["process_name"] || '--' }}</p>
                                  </div>
                                  <div class="lable-right">
                                    <p class="label">
                                      {{ i18n.mission_modal.lockSummary.filname }}
                                    </p>
                                    <p>{{ item.task_param.sourceLocation || '--' }}</p>
                                  </div>
                                  <div class="lable-right">
                                    <p class="label">
                                      {{ i18n.mission_modal.sysSource.source_path }}
                                    </p>
                                    <p>{{ item.task_param.assemblyLocation || '--' }}</p>
                                  </div>
                                </div>
                              </div>
                            </app-mission-panel>
                          </div>
                        </div>
                      </div>
                      <!-- 全景分析任务模板 system 1-->
                      <div class="table" *ngIf="obj['analysis-type'] === missArr[3]">
                        <div class="table-left">
                          <ul>
                            <ng-container *ngFor="let obje of missionDetail[3]">
                              <li *ngIf="!hasProperty(obje, 'dssTitle')">
                                <p tiOverflow>{{ obje.title }}</p>
                              </li>
                              <li *ngIf="hasProperty(obje, 'dssTitle') && obj.sceneSolution < 2">
                                <p tiOverflow>{{ obj.sceneSolution === 1 ? obje.bigDataTitle : obje.dssTitle }}</p>
                              </li>
                              <ng-container *ngIf="hasProperty(obje, 'dssTitle') && obj.sceneSolution === 2">
                                <li>
                                  <p tiOverflow>{{ i18n.databaseConfig.ip }}</p>
                                </li>
                                <li>
                                  <p tiOverflow>{{ i18n.databaseConfig.port }}</p>
                                </li>
                                <li>
                                  <p tiOverflow>{{ i18n.sys.scenes_tracing }}</p>
                                </li>
                                <li>
                                  <p tiOverflow>{{ i18n.sys.tracing_event }}</p>
                                </li>
                              </ng-container>
                            </ng-container>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ i18n.preSwitch.colectMethods }}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ i18n.preSwitch.pointTime }}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ i18n.preSwitch.pointDuration }}</p>
                            </li>
                          </ul>
                        </div>
                        <div class="table-right">
                          <ul>
                            <li>
                              <p>
                                {{ obj["taskname"]}}
                              </p>
                            </li>
                            <li>
                              <p>{{ (obj["interval"] || '--') | thousandSeparator }}</p>
                            </li>
                            <li>
                              <p>{{ (obj["duration"] || '--') | thousandSeparator }}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'sceneSolution') && obj.sceneSolution < 2">
                              <p>
                                {{ obj["configDir"] || '--' }}
                              </p>
                            </li>
                            <ng-container *ngIf="hasProperty(obj, 'sceneSolution') && obj.sceneSolution === 2">
                              <li>
                                <p>{{ obj.sqlIp }}</p>
                              </li>
                              <li>
                                <p>{{ obj.sqlPort || '--' }}</p>
                              </li>
                              <li>
                                <p>{{ obj.traceSwitch === true ? this.i18n.status_Yes : this.i18n.status_No }}</p>
                              </li>
                              <li>
                                <p>{{ obj.events || '--' }}</p>
                              </li>
                            </ng-container>
                            <li>
                              <p>
                                {{ obj["topCheck"] === true ? this.i18n.status_Yes : this.i18n.status_No }}
                              </p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>
                                {{
                                obj["cycle"]
                                ? i18n.preSwitch.duraColect
                                : i18n.preSwitch.onceColect
                                }}
                              </p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ obj["targetTime"] }}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ handleColectDate(obj) }}</p>
                            </li>
                          </ul>
                        </div>
                        <div *ngIf="obj.switch">
                          <div *ngFor="let item of obj.nodeConfig">
                            <app-mission-panel [title]="item.nodeName + '(' + item.nodeIp + ')'" [active]="false">
                              <div class="content-box">
                                <div class="content-list">
                                  <div class="lable-right">
                                    <p class="label">{{ i18n.databaseConfig.ip }}</p>
                                    <p>{{ item.task_param['sqlIp'] || '--' }}</p>
                                  </div>
                                  <div class="lable-right">
                                    <p class="label">{{ i18n.databaseConfig.port }}</p>
                                    <p>{{ item.task_param['sqlPort'] || '--' }}</p>
                                  </div>
                                </div>
                              </div>
                            </app-mission-panel>
                          </div>
                        </div>
                      </div>
                      <!-- 系统分析任务模板 resource_schedule 3-->
                      <div class="table" *ngIf="obj['analysis-type'] === missArr[5]">
                        <div class="table-left">
                          <ul *ngIf="obj['analysis-target'] === cPs">
                            <li *ngFor="let obje of missionDetail[5][0]">
                              <p>{{ obje.calcTitle ? obje.calcTitle(obj) : obje.title }}</p>
                            </li>

                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ i18n.preSwitch.colectMethods }}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ i18n.preSwitch.pointTime }}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ i18n.preSwitch.pointDuration }}</p>
                            </li>
                          </ul>
                          <ul *ngIf="obj['analysis-target'] === cAtp">
                            <li *ngFor="let obje of missionDetail[5][1]">
                              <p>{{ obje.calcTitle ? obje.calcTitle(obj) : obje.title }}</p>
                            </li>

                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ i18n.preSwitch.colectMethods }}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ i18n.preSwitch.pointTime }}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ i18n.preSwitch.pointDuration }}</p>
                            </li>
                          </ul>
                          <ul *ngIf="obj['analysis-target'] === cLa">
                            <li *ngFor="let obje of missionDetail[5][2]">
                              <p>{{ obje.calcTitle ? obje.calcTitle(obj) : obje.title }}</p>
                            </li>

                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ i18n.preSwitch.colectMethods }}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ i18n.preSwitch.pointTime }}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ i18n.preSwitch.pointDuration }}</p>
                            </li>
                          </ul>
                        </div>
                        <div class="table-right">
                          <ul>
                            <li>
                              <p>
                                {{ obj["taskname"]}}
                              </p>
                            </li>
                            <li>
                              <p>
                                {{ obj["analysis-target"] }}
                              </p>
                            </li>
                            <li>
                              <p *ngIf="obj['analysis-target'] === cPs">
                                {{ obj["duration"] || '--' }}
                              </p>
                            </li>

                            <li>
                              <p *ngIf="obj['analysis-target'] === cAtp">
                                {{ obj["target-pid"] || '--'}}
                              </p>
                            </li>
                            <li>
                              <p *ngIf="obj['analysis-target'] === cAtp">
                                {{ obj["process-name"] || '--'}}
                              </p>
                            </li>
                            <li>
                              <p *ngIf="obj['analysis-target'] === cAtp">
                                {{ obj["duration"] || '--' }}
                              </p>
                            </li>

                            <li>
                              <p *ngIf="obj['analysis-target'] === cLa">
                                {{ obj["app-dir"] || '--' }}
                              </p>
                            </li>
                            <li>
                              <p *ngIf="obj['analysis-target'] === cLa">
                                {{ obj["app-parameters"] || '--' }}
                              </p>
                            </li>
                            <li>
                              <p>{{ obj["assemblyLocation"] || '--' }}</p>
                            </li>
                            <li>
                              <p>{{ obj['dis-callstack'] === undefined ? '--' : (obj['dis-callstack'] ?
                                i18n.process.enable : i18n.process.disable) }}</p>
                            </li>
                            <li>
                              <p>{{ obj["size"] || '--' }}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>
                                {{
                                obj["cycle"]
                                ? i18n.preSwitch.duraColect
                                : i18n.preSwitch.onceColect
                                }}
                              </p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ obj["targetTime"] }}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ handleColectDate(obj) }}</p>
                            </li>

                          </ul>
                        </div>
                        <!-- panel -->
                        <div *ngIf="obj.switch">
                          <div *ngFor="let item of obj.nodeConfig">
                            <app-mission-panel [title]="item.nodeName + '(' + item.nodeIp + ')'" [active]="false">
                              <div class="content-box">
                                <div class="content-list" *ngIf="
                                item.task_param['analysis-target'].indexOf(
                                  'Profile'
                                ) !== -1
                              ">
                                  <div class="lable-right">
                                    <p class="label">
                                      {{ i18n.mission_modal.sysSource.file_path }}
                                    </p>
                                    <p>{{ item.task_param.assemblyLocation || '--' }}</p>
                                  </div>
                                </div>
                                <div class="content-list" *ngIf="
                                item.task_param['analysis-target'].indexOf(
                                  'Launch'
                                ) !== -1
                              ">
                                  <div class="lable-right">
                                    <p class="label">
                                      {{ i18n.mission_modal.sysSource.application }}
                                    </p>
                                    <p>{{ item.task_param["app-dir"] || '--' }}</p>
                                  </div>
                                  <div class="lable-right">
                                    <p class="label">
                                      {{ i18n.mission_modal.sysSource.app_params }}
                                    </p>
                                    <p>{{ item.task_param["app-parameters"] || '--' }}</p>
                                  </div>
                                  <div class="lable-right">
                                    <p class="label">
                                      {{ i18n.mission_modal.sysSource.file_path }}
                                    </p>
                                    <p>{{ item.task_param.assemblyLocation || '--' }}</p>
                                  </div>
                                </div>
                                <div class="content-list" *ngIf="
                                item.task_param['analysis-target'].indexOf(
                                  'Attach'
                                ) !== -1
                              ">
                                  <div class="lable-right">
                                    <p class="label">
                                      {{ i18n.mission_modal.sysSource.pid }}
                                    </p>
                                    <p>{{ item.task_param["target-pid"] || '--' }}</p>
                                  </div>
                                  <div class="lable-right">
                                    <p class="label">
                                      {{ i18n.mission_create.process_alias }}
                                    </p>
                                    <p>{{ item.task_param["process-name"] || '--' }}</p>
                                  </div>
                                  <div class="lable-right">
                                    <p class="label">
                                      {{ i18n.mission_modal.sysSource.file_path }}
                                    </p>
                                    <p>{{ item.task_param.assemblyLocation || '--' }}</p>
                                  </div>
                                </div>
                              </div>
                            </app-mission-panel>
                          </div>
                        </div>
                      </div>
                      <!-- 微架构分析任务模板 microarchitecture-->
                      <div class="table" *ngIf="obj['analysis-type'] === 'microarchitecture'">
                        <div class="table-left">
                          <ul>
                            <li>
                              <p>{{i18n.common_term_task_name}}</p>
                            </li>
                            <li>
                              <p>{{i18n.mission_create.mode}}</p>
                            </li>
                            <li *ngIf="obj.analysisTarget === 'Attach to Process'">
                              <p>{{ i18n.common_term_task_crate_pid}}</p>
                            </li>
                            <li *ngIf="obj.analysisTarget === 'Attach to Process'">
                              <p>{{ i18n.mission_create.process_alias}}</p>
                            </li>
                            <li *ngIf="obj.analysisTarget === 'Launch Application'">
                              <p>{{ i18n.common_term_task_crate_app_path}}</p>
                            </li>
                            <li *ngIf="obj.analysisTarget === 'Launch Application'">
                              <p>{{i18n.common_term_task_crate_parameters}}</p>
                            </li>
                            <li>
                              <p>{{i18n.micarch.label.simpling}}</p>
                            </li>
                            <li>
                              <p>{{i18n.sys.duration}}</p>
                            </li>
                            <li>
                              <p>{{i18n.mission_modal.syslock.cpu_interval}}</p>
                            </li>
                            <li>
                              <p>{{i18n.micarch.label.analysis}}</p>
                            </li>
                            <li *ngIf="obj.analysisTarget === 'Profile System'">
                              <p>{{i18n.ddr.cpuToBeSamples}}</p>
                            </li>
                            <li>
                              <p>{{i18n.micarch.label.typeItem}}</p>
                            </li>
                            <li>
                              <p>{{i18n.micarch.simpling_delay}}</p>
                            </li>
                            <li>
                              <p>{{i18n.common_term_task_crate_c_path}}</p>
                            </li>
                            <li>
                              <p>{{ i18n.mission_create.kcore }}</p>
                            </li>
                            <li>
                              <p>{{i18n.mission_create.collection_size}}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ i18n.preSwitch.colectMethods }}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ i18n.preSwitch.pointTime }}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ i18n.preSwitch.pointDuration }}</p>
                            </li>

                          </ul>
                        </div>
                        <div class="table-right">
                          <ul>
                            <li>
                              <p>
                                {{ obj["taskName"]}}
                              </p>
                            </li>
                            <li>
                              <p>
                                {{ obj["analysisTarget"] }}
                              </p>
                            </li>
                            <li *ngIf="obj.analysisTarget === 'Attach to Process'">
                              <p>
                                {{ obj["targetPid"] || '--' }}
                              </p>
                            </li>
                            <li *ngIf="obj.analysisTarget === 'Attach to Process'">
                              <p>
                                {{ obj["process_name"] || '--' }}
                              </p>
                            </li>
                            <li *ngIf="obj.analysisTarget === 'Launch Application'">
                              <p>{{ obj["appDir"] || '--' }}</p>
                            </li>
                            <li *ngIf="obj.analysisTarget === 'Launch Application'">
                              <p>{{obj["appParameters"] || '--'}}</p>
                            </li>
                            <li>
                              <p>
                                {{ obj["samplingMode"] || '--' }}
                              </p>
                            </li>
                            <li>
                              <p>
                                {{( obj["duration"] || '--' ) | thousandSeparator }}
                              </p>
                            </li>
                            <li>
                              <p>
                                {{ (obj["interval"] || '--') | thousandSeparator }}
                              </p>
                            </li>
                            <li>
                              <p>
                                {{ obj["analysisIndex"] || '--' }}
                              </p>
                            </li>
                            <li *ngIf="obj.analysisTarget === 'Profile System'">
                              <p>
                                {{ obj["cpuMask"] || '--' }}
                              </p>
                            </li>
                            <li>
                              <p>
                                {{ getMicarchType(obj["samplingSpace"]) }}
                              </p>
                            </li>
                            <li>
                              <p>
                                {{ obj["samplingDelay"] }}
                              </p>
                            </li>
                            <li>
                              <p>{{ obj["sourceLocation"] || '--' }}</p>
                            </li>
                            <li>
                              <p>{{ obj.kcore ? i18n.process.enable : i18n.process.disable }}</p>
                            </li>
                            <li>
                              <p>{{ obj["perfDataLimit"] || '--' }}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>
                                {{
                                obj["cycle"]
                                ? i18n.preSwitch.duraColect
                                : i18n.preSwitch.onceColect
                                }}
                              </p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ obj["targetTime"] }}</p>
                            </li>
                            <li *ngIf="hasProperty(obj, 'cycle')">
                              <p>{{ handleColectDate(obj) }}</p>
                            </li>

                          </ul>
                        </div>
                        <!-- panel -->
                        <div *ngIf="obj.switch">
                          <div *ngFor="let item of obj.nodeConfig">
                            <app-mission-panel [title]="item.nodeName + '(' + item.nodeIp + ')'" [active]="false">
                              <div class="content-box">
                                <div class="content-list" *ngIf="
                                      item.taskParam['analysisTarget'].indexOf(
                                        'Profile'
                                      ) !== -1
                                    ">
                                  <div class="lable-right">
                                    <p class="label">
                                      {{ i18n.common_term_task_crate_c_path }}
                                    </p>
                                    <p>{{ item.taskParam.sourceLocation || '--' }}</p>
                                  </div>
                                  <div class="lable-right">
                                    <p class="label">
                                      {{ i18n.ddr.cpuToBeSamples }}
                                    </p>
                                    <p>{{ item.taskParam.cpuMask || '--' }}</p>
                                  </div>
                                </div>
                                <div class="content-list"
                                  *ngIf="item.taskParam['analysisTarget'].indexOf('Launch') !== -1">
                                  <div class="lable-right">
                                    <p class="label">
                                      {{ i18n.common_term_task_crate_app_path}}
                                    </p>
                                    <p>{{ item.taskParam["appDir"] || '--' }}</p>
                                  </div>
                                  <div class="lable-right">
                                    <p class="label">
                                      {{ i18n.common_term_task_crate_parameters }}
                                    </p>
                                    <p>{{ item.taskParam["appParameters"] || '--' }}</p>
                                  </div>
                                  <div class="lable-right">
                                    <p class="label">
                                      {{ i18n.common_term_task_crate_c_path }}
                                    </p>
                                    <p>{{ item.taskParam.sourceLocation || '--' }}</p>
                                  </div>
                                </div>
                                <div class="content-list"
                                  *ngIf="item.taskParam['analysisTarget'].indexOf('Attach') !== -1">
                                  <div class="lable-right">
                                    <p class="label">{{ i18n.common_term_task_crate_pid }}</p>
                                    <p>{{ item.taskParam["targetPid"] || '--' }}</p>
                                  </div>
                                  <div class="lable-right">
                                    <p class="label">{{ i18n.mission_create.process_alias }}</p>
                                    <p>{{ item.taskParam["process_name"] || '--' }}</p>
                                  </div>
                                  <div class="lable-right">
                                    <p class="label">
                                      {{ i18n.common_term_task_crate_c_path}}
                                    </p>
                                    <p>{{ item.taskParam.sourceLocation || '--' }}</p>
                                  </div>
                                </div>
                              </div>
                            </app-mission-panel>
                          </div>
                        </div>
                      </div>
                      <!-- 访存分析、访存统计分析、Miss事件统计、进程/线程分析 -->
                      <div
                        *ngIf="['mem_access', 'miss_event', 'falsesharing', 'process-thread-analysis'].includes(obj['analysis-type'])">
                        <div class="list-info">
                          <div class="table">
                            <div class="config-info" *ngFor="let item of obj.configList">
                              <div class="table-left">{{item.key}}</div>
                              <div class="table-right" *ngIf="isInterval(item.key)"> {{item.text | thousandSeparator }}
                              </div>
                              <div class="table-right" *ngIf="!isInterval(item.key)"> {{item.text }} </div>
                            </div>

                            <!-- 配置节点参数 -->
                            <div *ngIf="obj.switch">
                              <div *ngFor="let item of obj.panelList; index as i">
                                <app-mission-panel
                                  [title]="obj.nodeConfig[i].nodeName + '(' + obj.nodeConfig[i].nodeIp + ')'"
                                  [active]="false">
                                  <div class="content-box config-info" *ngFor="let items of item">
                                    <div class="table-left">{{ items.key }}</div>
                                    <div class="table-right">{{items.text}}</div>
                                  </div>
                                </app-mission-panel>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <!-- IO 分析 -->
                      <div *ngIf="obj['analysis-type'] === 'ioperformance'">
                        <app-mission-io-detail [taskInfo]="obj" [detailTarget]="obj.detailTarget">
                        </app-mission-io-detail>
                      </div>
                      <div *ngIf="obj['analysis-type'] === 'hpc_analysis'">
                        <app-mission-hpc-detail [taskInfo]="obj" [detailTarget]="obj.detailTarget">
                        </app-mission-hpc-detail>
                      </div>
                      <div *ngIf="obj['analysis-type'] === 'memory_diagnostic'">
                        <app-diagnose-template [taskInfo]="obj" [detailTarget]="obj.detailTarget">
                        </app-diagnose-template>
                      </div>
                      <div *ngIf="obj['analysis-type'] === 'netio_diagnostic'" style="border-left: 2px solid #0067ff;">
                        <app-net-io-temp-detail [taskInfo]="obj"></app-net-io-temp-detail>
                      </div>
                      <div *ngIf="obj['analysis-type'] === 'storageio_diagnostic'" style="border-left: 2px solid #0067ff;">
                        <div style="padding-left: 20px;background-color: #fff;">
                          <app-storage-io-temp-detail [taskInfo]="obj"></app-storage-io-temp-detail>
                        </div>
                      </div>
                    </td>
                  </tr>
                </ng-container>
                <ng-container>
                  <tr *ngIf="srcData.data.length === 0 && !isLoading" class="nodataTr">
                    <td colspan="7" style="padding:0px;">
                      <div class="nodata" *ngIf="srcData.data.length === 0">
                        <img style='width:198px;display:block' src='./assets/img/projects/nodata.png' />
                        <div style="font-size: 0.8rem">{{nodataTips}}</div>
                      </div>
                    </td>
                  </tr>
                </ng-container>
              </tbody>
            </table>
          </div>
          <ti-pagination [(currentPage)]="currentPage" [pageSize]="pageSize" [(totalNumber)]="totalNumber">
          </ti-pagination>
        </ti-table>
      </div>

    </div>
  </div>
</div>

<app-pop-mask #multipleDeleteMask>
  <div class="content templates-del">
    <div class="mask-title">
      <span class="create-title">{{i18n.mission_modal.notice}}</span>
      <img class="incorrect" (click)="closeDelete()" src="./assets/img/header/close_icon.svg" style="cursor:pointer;">
    </div>
    <div class="tip_title">
      <img src="./assets/img/tip/warn_arr.svg" alt="">
      <span>{{i18n.mission_modal.noticeTwo}}</span>
    </div>
    <div class="content_container">
      <ti-table [(displayedData)]="displayedOk" [srcData]="srcDataOk" [columns]="columns.slice(0,3)">
        <div class="ti3-table-fixed-head">
          <table style="table-layout: fixed;">
            <thead>
              <tr>
                <!--使用复选框时，需要给复选框列加 checkbox-column 属性-->
                <th checkbox-column width='10%'>
                  <!--全选按钮-->
                  <!--如果有分页，全选需要控制当前页时，items接口传入displayed
                    如果全选要控制表格所有数据，items接口传入srcData.data-->
                  <input type="checkbox" tiCheckgroup [items]="srcDataOk.data" [(checkeds)]="checkedListOk"
                    (change)=toggleSelect() />
                </th>
                <ng-container *ngFor="let column of columns.slice(0,popColumnNum);index as i;">
                  <th tiOverflow>{{column.title}}</th>
                </ng-container>
              </tr>
            </thead>
          </table>
        </div>
        <div class="ti3-table-container container-box">
          <table style="border-collapse: collapse;">
            <thead>
              <tr>
                <th checkbox-column width='10%'></th>
                <!--此处的表头是用来控制各列宽度，实际不显示，所以注意 th 标签内部不要嵌套任何内容。-->
                <th *ngFor="let column of columns.slice(0,popColumnNum)"></th>
              </tr>
            </thead>

            <tbody>
              <!--注意:ngFor中的displayed数据与displayedData传入的数据一致, 初始化设置为[]即可-->
              <ng-container *ngFor="let row of displayedOk;index as i;trackBy: trackByFn">
                <tr>
                  <td checkbox-column>
                    <input type="checkbox" tiCheckitem [item]="row" (change)=toggleSelect() />
                  </td>
                  <td tiOverflow>{{ row.templateName}}</td>
                  <td tiOverflow>{{ row.analysisTargetText }}</td>
                  <td tiOverflow *ngIf="!isDiagnose">{{ row.analysisType }}</td>
                </tr>
              </ng-container>
            </tbody>
          </table>
        </div>
        <ti-pagination type="mini" [(totalNumber)]="srcDataOk.data.length"></ti-pagination>
      </ti-table>
    </div>
    <div class="footer_button">
      <button type="button" tiButton style="margin-right:16px;" (click)='multipleDeleteOk()'
        [disabled]='checkedListOk.length == 0'>{{i18n.common_term_operate_ok}}</button>
      <button type="button" tiButton (click)='closeDelete()' color="primary">{{i18n.common_term_operate_cancel}}</button>
    </div>
  </div>
</app-pop-mask>